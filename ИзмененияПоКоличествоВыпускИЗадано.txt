ВЫБРАТЬ
	БВ_ПризнакиНормируемостиНоменклатурыСрезПоследних.Номенклатура,
	МАКСИМУМ(БВ_ПризнакиНормируемостиНоменклатурыСрезПоследних.Нормируемая) КАК Нормируемая,
	МАКСИМУМ(БВ_ПризнакиНормируемостиНоменклатурыСрезПоследних.Ненормируемая) КАК Ненормируемая,
	МАКСИМУМ(БВ_ПризнакиНормируемостиНоменклатурыСрезПоследних.НаТехнологию) КАК НаТехнологию,
	МАКСИМУМ(БВ_ПризнакиНормируемостиНоменклатурыСрезПоследних.СтатьяБюджета) КАК СтатьяБюджета,
	МАКСИМУМ(БВ_ПризнакиНормируемостиНоменклатурыСрезПоследних.БазаНормирования) КАК БазаНормирования,
	БВ_ПризнакиНормируемостиНоменклатурыСрезПоследних.Подразделение
ПОМЕСТИТЬ ПризнакиНормируемостиНоменклатуры
ИЗ
	РегистрСведений.БВ_ПризнакиНормируемостиНоменклатуры.СрезПоследних(&КонДата, Подразделение В ИЕРАРХИИ (&Подразделение)) КАК БВ_ПризнакиНормируемостиНоменклатурыСрезПоследних

СГРУППИРОВАТЬ ПО
	БВ_ПризнакиНормируемостиНоменклатурыСрезПоследних.Номенклатура,
	БВ_ПризнакиНормируемостиНоменклатурыСрезПоследних.Подразделение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Номенклатура.Ссылка КАК Продукция
ПОМЕСТИТЬ СпособыРаспределения
ИЗ
	Справочник.Номенклатура КАК Номенклатура
ГДЕ
	Номенклатура.НоменклатурнаяГруппа В
			(ВЫБРАТЬ
				СпособыРаспределенияЗатратНаВыпускФильтры.НоменклатурнаяГруппа
			ИЗ
				Справочник.СпособыРаспределенияЗатратНаВыпуск.Фильтры КАК СпособыРаспределенияЗатратНаВыпускФильтры
			ГДЕ
				СпособыРаспределенияЗатратНаВыпускФильтры.Ссылка.Наименование ПОДОБНО "только годный выпуск_ПЦ1  По объему выпуска%")
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Организация КАК Организация,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Подразделение КАК Подразделение,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Продукция КАК Продукция,
	ЕСТЬNULL(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.СуммаОстаток, 0) КАК СуммаОборот,
	ЕСТЬNULL(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.КоличествоОстаток, 0) КАК КоличествоОборот,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.СтатьяЗатрат КАК СтатьяЗатрат,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Затрата КАК Затрата,
	ВЫБОР
		КОГДА НЕ ВЫРАЗИТЬ(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Затрата КАК Справочник.Номенклатура) ЕСТЬ NULL
			ТОГДА ВЫРАЗИТЬ(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Затрата КАК Справочник.Номенклатура).НоменклатурнаяГруппа
	КОНЕЦ КАК НоменклатурнаяГруппаЗатрат,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.НоменклатурнаяГруппа
ПОМЕСТИТЬ НЗПНаНачалоЗатраты
ИЗ
	РегистрНакопления.ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчет.Остатки(
			&НачДата,
			Организация = &Организация
				И Подразделение В ИЕРАРХИИ (&Подразделение)
				И Продукция В
					(ВЫБРАТЬ
						СпособыРаспределения.Продукция
					ИЗ
						СпособыРаспределения КАК СпособыРаспределения)) КАК ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Организация,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Подразделение,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Продукция,
	ЕСТЬNULL(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.СуммаРасход, 0),
	ЕСТЬNULL(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.КоличествоРасход, 0),
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.СтатьяЗатрат,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Затрата,
	ВЫБОР
		КОГДА НЕ ВЫРАЗИТЬ(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Затрата КАК Справочник.Номенклатура) ЕСТЬ NULL
			ТОГДА ВЫРАЗИТЬ(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Затрата КАК Справочник.Номенклатура).НоменклатурнаяГруппа
	КОНЕЦ,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.НоменклатурнаяГруппа
ИЗ
	РегистрНакопления.ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчет.Обороты(
			НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(&НачДата, МЕСЯЦ, -1), МЕСЯЦ),
			КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(&КонДата, МЕСЯЦ, -1), МЕСЯЦ),
			,
			Организация = &Организация
				И Подразделение В ИЕРАРХИИ (&Подразделение)
				И Продукция В
					(ВЫБРАТЬ
						СпособыРаспределения.Продукция
					ИЗ
						СпособыРаспределения КАК СпособыРаспределения)) КАК ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Организация КАК Организация,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Подразделение КАК Подразделение,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Продукция КАК Продукция,
	ЕСТЬNULL(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.СуммаОстаток, 0) КАК СуммаОборот,
	ЕСТЬNULL(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.КоличествоОстаток, 0) КАК КоличествоОборот,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.СтатьяЗатрат КАК СтатьяЗатрат,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Затрата КАК Затрата,
	ВЫБОР
		КОГДА НЕ ВЫРАЗИТЬ(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Затрата КАК Справочник.Номенклатура) ЕСТЬ NULL
			ТОГДА ВЫРАЗИТЬ(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Затрата КАК Справочник.Номенклатура).НоменклатурнаяГруппа
	КОНЕЦ КАК НоменклатурнаяГруппаЗатрат,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.НоменклатурнаяГруппа
ПОМЕСТИТЬ НЗПНаКонецЗатраты
ИЗ
	РегистрНакопления.ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчет.Остатки(
			ДОБАВИТЬКДАТЕ(&КонДата, СЕКУНДА, 1),
			Организация = &Организация
				И Подразделение В ИЕРАРХИИ (&Подразделение)
				И Продукция В
					(ВЫБРАТЬ
						СпособыРаспределения.Продукция
					ИЗ
						СпособыРаспределения КАК СпособыРаспределения)) КАК ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Организация,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Подразделение,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Продукция,
	ЕСТЬNULL(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.СуммаРасход, 0),
	ЕСТЬNULL(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.КоличествоРасход, 0),
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.СтатьяЗатрат,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Затрата,
	ВЫБОР
		КОГДА НЕ ВЫРАЗИТЬ(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Затрата КАК Справочник.Номенклатура) ЕСТЬ NULL
			ТОГДА ВЫРАЗИТЬ(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Затрата КАК Справочник.Номенклатура).НоменклатурнаяГруппа
	КОНЕЦ,
	ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.НоменклатурнаяГруппа
ИЗ
	РегистрНакопления.ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчет.Обороты(
			&НачДата,
			&КонДата,
			,
			Организация = &Организация
				И Подразделение В ИЕРАРХИИ (&Подразделение)
				И Продукция В
					(ВЫБРАТЬ
						СпособыРаспределения.Продукция
					ИЗ
						СпособыРаспределения КАК СпособыРаспределения)) КАК ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗатратыНаВыпускПродукцииБухгалтерскийУчетОбороты.Организация КАК Организация,
	ЗатратыНаВыпускПродукцииБухгалтерскийУчетОбороты.Подразделение КАК Подразделение,
	ЗатратыНаВыпускПродукцииБухгалтерскийУчетОбороты.Продукция КАК Продукция,
	ЗатратыНаВыпускПродукцииБухгалтерскийУчетОбороты.СтатьяЗатрат КАК СтатьяЗатрат,
	ЗатратыНаВыпускПродукцииБухгалтерскийУчетОбороты.Затрата КАК Затрата,
	ЗатратыНаВыпускПродукцииБухгалтерскийУчетОбороты.КоличествоОборот КАК КоличествоОборот,
	ЗатратыНаВыпускПродукцииБухгалтерскийУчетОбороты.СуммаОборот КАК СуммаОборот,
	ВЫБОР
		КОГДА НЕ ВЫРАЗИТЬ(ЗатратыНаВыпускПродукцииБухгалтерскийУчетОбороты.Затрата КАК Справочник.Номенклатура) ЕСТЬ NULL
			ТОГДА ВЫРАЗИТЬ(ЗатратыНаВыпускПродукцииБухгалтерскийУчетОбороты.Затрата КАК Справочник.Номенклатура).НоменклатурнаяГруппа
	КОНЕЦ КАК НоменклатурнаяГруппаЗатрат,
	ЗНАЧЕНИЕ(Перечисление.ВидыВыпуска.Выпуск) КАК ВидВыпуска,
	ЗатратыНаВыпускПродукцииБухгалтерскийУчетОбороты.НоменклатурнаяГруппа,
	0 КАК КоличествоНЗПНаНачало,
	0 КАК СуммаНЗПНаНачало,
	0 КАК КоличествоНЗПНаКонец,
	0 КАК СуммаНЗПНаКонец
ПОМЕСТИТЬ ЗатратыНаВыпускПлюсНаработка
ИЗ
	РегистрНакопления.ЗатратыНаВыпускПродукцииБухгалтерскийУчет.Обороты(
			&НачДата,
			&КонДата,
			,
			Организация = &Организация
				И Подразделение В ИЕРАРХИИ (&Подразделение)) КАК ЗатратыНаВыпускПродукцииБухгалтерскийУчетОбороты

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НЗПНаНачалоЗатраты.Организация,
	НЗПНаНачалоЗатраты.Подразделение,
	НЗПНаНачалоЗатраты.Продукция,
	НЗПНаНачалоЗатраты.СтатьяЗатрат,
	НЗПНаНачалоЗатраты.Затрата,
	0,
	0,
	НЗПНаНачалоЗатраты.НоменклатурнаяГруппаЗатрат,
	ЗНАЧЕНИЕ(Перечисление.ВидыВыпуска.Наработка),
	НЗПНаНачалоЗатраты.НоменклатурнаяГруппа,
	НЗПНаНачалоЗатраты.КоличествоОборот,
	НЗПНаНачалоЗатраты.СуммаОборот,
	0,
	0
ИЗ
	НЗПНаНачалоЗатраты КАК НЗПНаНачалоЗатраты

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НЗПНаКонецЗатраты.Организация,
	НЗПНаКонецЗатраты.Подразделение,
	НЗПНаКонецЗатраты.Продукция,
	НЗПНаКонецЗатраты.СтатьяЗатрат,
	НЗПНаКонецЗатраты.Затрата,
	0,
	0,
	НЗПНаКонецЗатраты.НоменклатурнаяГруппаЗатрат,
	ЗНАЧЕНИЕ(Перечисление.ВидыВыпуска.Наработка),
	НЗПНаКонецЗатраты.НоменклатурнаяГруппа,
	0,
	0,
	НЗПНаКонецЗатраты.КоличествоОборот,
	НЗПНаКонецЗатраты.СуммаОборот
ИЗ
	НЗПНаКонецЗатраты КАК НЗПНаКонецЗатраты
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗатратыНаВыпуск.Организация,
	ЗатратыНаВыпуск.Подразделение,
	ЗатратыНаВыпуск.Продукция,
	ЗатратыНаВыпуск.СтатьяЗатрат,
	ЗатратыНаВыпуск.Затрата,
	СУММА(ЗатратыНаВыпуск.КоличествоОборот) КАК КоличествоОборот,
	СУММА(ЗатратыНаВыпуск.СуммаОборот) КАК СуммаОборот,
	ЗатратыНаВыпуск.НоменклатурнаяГруппаЗатрат
ПОМЕСТИТЬ ЗатратыНаВыпуск
ИЗ
	(ВЫБРАТЬ
		ЗНВППлюсНаработка.Организация КАК Организация,
		ЗНВППлюсНаработка.Подразделение КАК Подразделение,
		ЗНВППлюсНаработка.Продукция КАК Продукция,
		ЗНВППлюсНаработка.СтатьяЗатрат КАК СтатьяЗатрат,
		ЗНВППлюсНаработка.Затрата КАК Затрата,
		ЗНВППлюсНаработка.КоличествоОборот - ЗНВППлюсНаработка.КоличествоНЗПНаНачало + ЗНВППлюсНаработка.КоличествоНЗПНаКонец КАК КоличествоОборот,
		ЗНВППлюсНаработка.СуммаОборот - ЗНВППлюсНаработка.СуммаНЗПНаНачало + ЗНВППлюсНаработка.СуммаНЗПНаКонец КАК СуммаОборот,
		ЗНВППлюсНаработка.НоменклатурнаяГруппаЗатрат КАК НоменклатурнаяГруппаЗатрат
	ИЗ
		ЗатратыНаВыпускПлюсНаработка КАК ЗНВППлюсНаработка
	ГДЕ
		ВЫБОР
				КОГДА ЗНВППлюсНаработка.ВидВыпуска = ЗНАЧЕНИЕ(Перечисление.ВидыВыпуска.Наработка)
					ТОГДА ИСТИНА
				КОГДА ЗНВППлюсНаработка.НоменклатурнаяГруппа.Наименование ПОДОБНО "Металлопродукция"
					ТОГДА ИСТИНА
				КОГДА ЗНВППлюсНаработка.НоменклатурнаяГруппа.Наименование ПОДОБНО "Полуфабрикаты"
					ТОГДА ИСТИНА
				ИНАЧЕ ЛОЖЬ
			КОНЕЦ) КАК ЗатратыНаВыпуск

СГРУППИРОВАТЬ ПО
	ЗатратыНаВыпуск.Организация,
	ЗатратыНаВыпуск.Подразделение,
	ЗатратыНаВыпуск.Продукция,
	ЗатратыНаВыпуск.СтатьяЗатрат,
	ЗатратыНаВыпуск.Затрата,
	ЗатратыНаВыпуск.НоменклатурнаяГруппаЗатрат
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗатратыНаВыпуск.Организация,
	ЗатратыНаВыпуск.Подразделение,
	ЗатратыНаВыпуск.Продукция,
	ВЫБОР
		КОГДА ЗатратыНаВыпуск.СтатьяЗатрат = &Отходы
			ТОГДА ВЫБОР
					КОГДА ЗатратыНаВыпуск.Затрата.Наименование ПОДОБНО "Обрезь%"
						ТОГДА ЗатратыНаВыпуск.СтатьяЗатрат
					КОГДА ЗатратыНаВыпуск.Затрата.Наименование ПОДОБНО "Обжим%"
						ТОГДА ЗатратыНаВыпуск.СтатьяЗатрат
					КОГДА ЗатратыНаВыпуск.Затрата.Наименование ПОДОБНО "Продукт железосодержащий%"
						ТОГДА ЗатратыНаВыпуск.СтатьяЗатрат
					КОГДА ЗатратыНаВыпуск.Затрата.Наименование ПОДОБНО "Сварочный шлак%"
						ТОГДА ЗатратыНаВыпуск.СтатьяЗатрат
					КОГДА ЗатратыНаВыпуск.Затрата.Наименование ПОДОБНО "Лом стальной негабаритный тяжеловесный (для переработки) вид 500%"
						ТОГДА ЗатратыНаВыпуск.СтатьяЗатрат
					ИНАЧЕ &Прочие
				КОНЕЦ
		ИНАЧЕ ЗатратыНаВыпуск.СтатьяЗатрат
	КОНЕЦ КАК СтатьяЗатрат,
	ЗатратыНаВыпуск.Затрата,
	ЗатратыНаВыпуск.КоличествоОборот,
	ЗатратыНаВыпуск.СуммаОборот,
	ЗатратыНаВыпуск.СтатьяЗатрат.ВидЗатрат,
	ЗатратыНаВыпуск.СтатьяЗатрат.ХарактерЗатрат,
	ЗатратыНаВыпуск.СтатьяЗатрат.ПостояннаяЗатрата,
	ЗатратыНаВыпуск.НоменклатурнаяГруппаЗатрат,
	ВЫБОР
		КОГДА ПризнакиНормируемостиНоменклатуры.Нормируемая = ИСТИНА
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК Нормируемая,
	ЗатратыНаВыпуск.Затрата.ЕдиницаХраненияОстатков
ПОМЕСТИТЬ БазоваяВыборкаЗнВП
ИЗ
	ЗатратыНаВыпуск КАК ЗатратыНаВыпуск
		ЛЕВОЕ СОЕДИНЕНИЕ ПризнакиНормируемостиНоменклатуры КАК ПризнакиНормируемостиНоменклатуры
		ПО ЗатратыНаВыпуск.Затрата = ПризнакиНормируемостиНоменклатуры.Номенклатура
ГДЕ
	ЗатратыНаВыпуск.Продукция В
			(ВЫБРАТЬ
				СпособыРаспределения.Продукция
			ИЗ
				СпособыРаспределения КАК СпособыРаспределения)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВыпускПродукцииБухгалтерскийУчет.Организация,
	ВыпускПродукцииБухгалтерскийУчет.Подразделение,
	ВыпускПродукцииБухгалтерскийУчет.Продукция,
	СУММА(ВыпускПродукцииБухгалтерскийУчет.Количество) КАК Количество,
	СУММА(ВыпускПродукцииБухгалтерскийУчет.Стоимость) КАК Стоимость,
	ВыпускПродукцииБухгалтерскийУчет.КодОперации,
	ВыпускПродукцииБухгалтерскийУчет.ПодразделениеПолучатель,
	ВыпускПродукцииБухгалтерскийУчет.СтатьяЗатратПолучатель
ПОМЕСТИТЬ УслугиЦехов
ИЗ
	РегистрНакопления.ВыпускПродукцииБухгалтерскийУчет КАК ВыпускПродукцииБухгалтерскийУчет
ГДЕ
	ВыпускПродукцииБухгалтерскийУчет.Период МЕЖДУ &НачДата И &КонДата
	И ВыпускПродукцииБухгалтерскийУчет.ПодразделениеПолучатель В ИЕРАРХИИ(&Подразделение)
	И НЕ ВыпускПродукцииБухгалтерскийУчет.КодОперации В (&СписокКодовОпераций)
	И ВыпускПродукцииБухгалтерскийУчет.Активность
	И ВыпускПродукцииБухгалтерскийУчет.СтатьяЗатратПолучатель В(&СтатьиЗатратСодержаниеОхранаТрудаПрочиеРемонтыТранспорт)

СГРУППИРОВАТЬ ПО
	ВыпускПродукцииБухгалтерскийУчет.Организация,
	ВыпускПродукцииБухгалтерскийУчет.Подразделение,
	ВыпускПродукцииБухгалтерскийУчет.Продукция,
	ВыпускПродукцииБухгалтерскийУчет.КодОперации,
	ВыпускПродукцииБухгалтерскийУчет.ПодразделениеПолучатель,
	ВыпускПродукцииБухгалтерскийУчет.СтатьяЗатратПолучатель
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗатратыБухгалтерскийУчет.Организация,
	ЗатратыБухгалтерскийУчет.Подразделение,
	ЗатратыБухгалтерскийУчет.СтатьяЗатрат,
	СУММА(ЗатратыБухгалтерскийУчет.Сумма) КАК Сумма,
	ЗатратыБухгалтерскийУчет.Регистратор
ПОМЕСТИТЬ ЗатратыБУ
ИЗ
	РегистрНакопления.ЗатратыБухгалтерскийУчет КАК ЗатратыБухгалтерскийУчет
ГДЕ
	ЗатратыБухгалтерскийУчет.Период МЕЖДУ &НачДата И &КонДата
	И ЗатратыБухгалтерскийУчет.Активность
	И ЗатратыБухгалтерскийУчет.Организация = &Организация
	И ЗатратыБухгалтерскийУчет.Подразделение В ИЕРАРХИИ(&Подразделение)
	И НЕ ЗатратыБухгалтерскийУчет.Регистратор ССЫЛКА Документ.РасчетСебестоимостиВыпуска
	И НЕ ЗатратыБухгалтерскийУчет.Регистратор ССЫЛКА Документ.РасчетСебестоимостиВыпуска
	И ЗатратыБухгалтерскийУчет.ВидДвижения = &ВидДвиженнияПриход
	И ЗатратыБухгалтерскийУчет.СтатьяЗатрат В(&СтатьиЗатратСодержаниеОхранаТрудаПрочиеРемонтыТранспорт)

СГРУППИРОВАТЬ ПО
	ЗатратыБухгалтерскийУчет.Организация,
	ЗатратыБухгалтерскийУчет.Подразделение,
	ЗатратыБухгалтерскийУчет.СтатьяЗатрат,
	ЗатратыБухгалтерскийУчет.Регистратор
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Номенклатура,
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Качество,
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Регистратор,
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Количество КАК КоличествоРасход,
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Стоимость КАК СтоимостьРасход,
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Организация,
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.КорСубконто2,
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.ДокументОприходования
ПОМЕСТИТЬ ПартииБУ
ИЗ
	РегистрНакопления.ПартииТоваровНаСкладахБухгалтерскийУчет КАК ПартииТоваровНаСкладахБухгалтерскийУчетОбороты
ГДЕ
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Регистратор В
			(ВЫБРАТЬ
				ЗатратыБУ.Регистратор
			ИЗ
				ЗатратыБУ КАК ЗатратыБУ)
	И ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Период МЕЖДУ &НачДата И &КонДата
	И ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Организация = &Организация
	И ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПартииБУ.Организация,
	ПартииБУ.Номенклатура,
	ПартииБУ.Качество,
	ПартииБУ.КоличествоРасход,
	ПартииБУ.СтоимостьРасход,
	ПартииБУ.Регистратор,
	ПартииБУ.ДокументОприходования
ПОМЕСТИТЬ ПартииБУСобственные
ИЗ
	ПартииБУ КАК ПартииБУ
ГДЕ
	ПартииБУ.ДокументОприходования.Дата МЕЖДУ &НачДата И &КонДата
	И ПартииБУ.ДокументОприходования ССЫЛКА Документ.ОтчетПроизводстваЗаСмену
	И ПартииБУ.Качество.Наименование ПОДОБНО "Собственные%"
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПартииТоваровНаСкладахБухгалтерскийУчет.Номенклатура,
	ПартииТоваровНаСкладахБухгалтерскийУчет.Качество,
	СУММА(ПартииТоваровНаСкладахБухгалтерскийУчет.Количество) КАК Количество,
	СУММА(ПартииТоваровНаСкладахБухгалтерскийУчет.Стоимость) КАК Стоимость,
	ПартииТоваровНаСкладахБухгалтерскийУчет.Организация,
	ПартииТоваровНаСкладахБухгалтерскийУчет.КорСубконто2,
	ПартииТоваровНаСкладахБухгалтерскийУчет.ДокументДвижения
ПОМЕСТИТЬ ПартииБУСобственныеСтоимость
ИЗ
	РегистрНакопления.ПартииТоваровНаСкладахБухгалтерскийУчет КАК ПартииТоваровНаСкладахБухгалтерскийУчет
ГДЕ
	ПартииТоваровНаСкладахБухгалтерскийУчет.Организация = &Организация
	И ПартииТоваровНаСкладахБухгалтерскийУчет.Период МЕЖДУ &НачДата И &КонДата
	И ПартииТоваровНаСкладахБухгалтерскийУчет.Регистратор ССЫЛКА Документ.РасчетСебестоимостиВыпуска
	И ПартииТоваровНаСкладахБухгалтерскийУчет.ДокументОприходования В
			(ВЫБРАТЬ
				ПартииБУСобственные.ДокументОприходования
			ИЗ
				ПартииБУСобственные КАК ПартииБУСобственные)
	И ПартииТоваровНаСкладахБухгалтерскийУчет.ДокументДвижения В
			(ВЫБРАТЬ
				ПартииБУСобственные.Регистратор
			ИЗ
				ПартииБУСобственные КАК ПартииБУСобственные)

СГРУППИРОВАТЬ ПО
	ПартииТоваровНаСкладахБухгалтерскийУчет.Номенклатура,
	ПартииТоваровНаСкладахБухгалтерскийУчет.Качество,
	ПартииТоваровНаСкладахБухгалтерскийУчет.Организация,
	ПартииТоваровНаСкладахБухгалтерскийУчет.КорСубконто2,
	ПартииТоваровНаСкладахБухгалтерскийУчет.ДокументДвижения
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПартииБУВсе.Номенклатура,
	ПартииБУВсе.Качество,
	ПартииБУВсе.Регистратор,
	СУММА(ПартииБУВсе.КоличествоРасход) КАК КоличествоРасход,
	СУММА(ПартииБУВсе.СтоимостьРасход) КАК СтоимостьРасход,
	ПартииБУВсе.Организация,
	ПартииБУВсе.КорСубконто2
ПОМЕСТИТЬ ПартииБУВсе
ИЗ
	(ВЫБРАТЬ
		ПартииБУ.Номенклатура КАК Номенклатура,
		ПартииБУ.Качество КАК Качество,
		ПартииБУ.Регистратор КАК Регистратор,
		ПартииБУ.КоличествоРасход КАК КоличествоРасход,
		ПартииБУ.СтоимостьРасход КАК СтоимостьРасход,
		ПартииБУ.Организация КАК Организация,
		ПартииБУ.КорСубконто2 КАК КорСубконто2
	ИЗ
		ПартииБУ КАК ПартииБУ
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ПартииБУСобственныеСтоимость.Номенклатура,
		ПартииБУСобственныеСтоимость.Качество,
		ПартииБУСобственныеСтоимость.ДокументДвижения,
		ПартииБУСобственныеСтоимость.Количество,
		ПартииБУСобственныеСтоимость.Стоимость,
		ПартииБУСобственныеСтоимость.Организация,
		ПартииБУСобственныеСтоимость.КорСубконто2
	ИЗ
		ПартииБУСобственныеСтоимость КАК ПартииБУСобственныеСтоимость) КАК ПартииБУВсе

СГРУППИРОВАТЬ ПО
	ПартииБУВсе.Номенклатура,
	ПартииБУВсе.Качество,
	ПартииБУВсе.Регистратор,
	ПартииБУВсе.Организация,
	ПартииБУВсе.КорСубконто2
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗатратыБУ.Организация,
	ЗатратыБУ.Подразделение,
	ЗатратыБУ.СтатьяЗатрат,
	ЗатратыБУ.Сумма,
	ПартииБУ.Номенклатура,
	ПартииБУ.Качество,
	ПартииБУ.КоличествоРасход,
	ПартииБУ.СтоимостьРасход,
	ЗатратыБУ.Регистратор
ПОМЕСТИТЬ ЗатратыПартииБУ
ИЗ
	ЗатратыБУ КАК ЗатратыБУ
		ЛЕВОЕ СОЕДИНЕНИЕ ПартииБУВсе КАК ПартииБУ
		ПО ЗатратыБУ.Регистратор = ПартииБУ.Регистратор
			И (ВЫБОР
				КОГДА ЗатратыБУ.Регистратор ССЫЛКА Документ.ТребованиеНакладная
					ТОГДА ЗатратыБУ.СтатьяЗатрат = ПартииБУ.КорСубконто2
				ИНАЧЕ ИСТИНА
			КОНЕЦ)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗатратыПартииБУ.Организация,
	ЗатратыПартииБУ.Подразделение,
	ЗатратыПартииБУ.СтатьяЗатрат,
	ЗатратыПартииБУ.Сумма,
	ЗатратыПартииБУ.Номенклатура,
	ЗатратыПартииБУ.Качество,
	ЗатратыПартииБУ.КоличествоРасход,
	ЗатратыПартииБУ.СтоимостьРасход,
	ЗатратыПартииБУ.Регистратор,
	ВЫБОР
		КОГДА ЗатратыПартииБУ.Номенклатура ЕСТЬ NULL
			ТОГДА NULL
		ИНАЧЕ ЕСТЬNULL(ПризнакиНормируемостиНоменклатуры.Нормируемая, ЛОЖЬ)
	КОНЕЦ КАК Нормируемая,
	ЗатратыПартииБУ.Номенклатура.НоменклатурнаяГруппа
ПОМЕСТИТЬ ЗатратыПартииБУПризнаки
ИЗ
	ЗатратыПартииБУ КАК ЗатратыПартииБУ
		ЛЕВОЕ СОЕДИНЕНИЕ ПризнакиНормируемостиНоменклатуры КАК ПризнакиНормируемостиНоменклатуры
		ПО ЗатратыПартииБУ.Номенклатура = ПризнакиНормируемостиНоменклатуры.Номенклатура
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ОприходованиеМатериаловИзПроизводстваМатериалы.Ссылка.Организация,
	ОприходованиеМатериаловИзПроизводстваМатериалы.Ссылка.ПодразделениеОрганизации КАК Подразделение,
	&Прочие КАК СтатьяЗатрат,
	ОприходованиеМатериаловИзПроизводстваМатериалы.Номенклатура,
	СУММА(ОприходованиеМатериаловИзПроизводстваМатериалы.Количество) КАК Количество,
	ОприходованиеМатериаловИзПроизводстваМатериалы.ЕдиницаИзмерения,
	СУММА(ОприходованиеМатериаловИзПроизводстваМатериалы.Сумма) КАК Сумма,
	ОприходованиеМатериаловИзПроизводстваМатериалы.Ссылка КАК Регистратор
ПОМЕСТИТЬ ОтходыПрочие
ИЗ
	Документ.ОприходованиеМатериаловИзПроизводства.Материалы КАК ОприходованиеМатериаловИзПроизводстваМатериалы
ГДЕ
	ОприходованиеМатериаловИзПроизводстваМатериалы.Ссылка.Дата МЕЖДУ &НачДата И &КонДата
	И ОприходованиеМатериаловИзПроизводстваМатериалы.Ссылка.ПодразделениеОрганизации В ИЕРАРХИИ
			(ВЫБРАТЬ
				БазоваяВыборкаЗнВП.Подразделение
			ИЗ
				БазоваяВыборкаЗнВП КАК БазоваяВыборкаЗнВП
			СГРУППИРОВАТЬ ПО
				БазоваяВыборкаЗнВП.Подразделение)
	И ВЫБОР
			КОГДА ОприходованиеМатериаловИзПроизводстваМатериалы.Номенклатура.Наименование ПОДОБНО "Обрезь%"
				ТОГДА ЛОЖЬ
			КОГДА ОприходованиеМатериаловИзПроизводстваМатериалы.Номенклатура.Наименование ПОДОБНО "Обжим%"
				ТОГДА ЛОЖЬ
			КОГДА ОприходованиеМатериаловИзПроизводстваМатериалы.Номенклатура.Наименование ПОДОБНО "Продукт железосодержащий%"
				ТОГДА ЛОЖЬ
			КОГДА ОприходованиеМатериаловИзПроизводстваМатериалы.Номенклатура.Наименование ПОДОБНО "Сварочный шлак%"
				ТОГДА ЛОЖЬ
			КОГДА ОприходованиеМатериаловИзПроизводстваМатериалы.Номенклатура.Наименование ПОДОБНО "Лом стальной негабаритный тяжеловесный (для переработки) вид 500%"
				ТОГДА ЛОЖЬ
			ИНАЧЕ ИСТИНА
		КОНЕЦ

СГРУППИРОВАТЬ ПО
	ОприходованиеМатериаловИзПроизводстваМатериалы.Ссылка.Организация,
	ОприходованиеМатериаловИзПроизводстваМатериалы.Ссылка.ПодразделениеОрганизации,
	ОприходованиеМатериаловИзПроизводстваМатериалы.Номенклатура,
	ОприходованиеМатериаловИзПроизводстваМатериалы.ЕдиницаИзмерения,
	ОприходованиеМатериаловИзПроизводстваМатериалы.Ссылка
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Номенклатура,
	"Собственные" КАК ПокупныеСобственные,
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Регистратор,
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Количество КАК КоличествоРасход,
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Стоимость КАК СтоимостьРасход,
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Организация,
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Регистратор.ПодразделениеОрганизации КАК Подразделение,
	ВЫБОР
		КОГДА ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Номенклатура ЕСТЬ NULL
			ТОГДА NULL
		ИНАЧЕ ЕСТЬNULL(ПризнакиНормируемостиНоменклатуры.Нормируемая, ЛОЖЬ)
	КОНЕЦ КАК Нормируемая,
	&Прочие КАК СтатьяЗатрат,
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Номенклатура.НоменклатурнаяГруппа
ПОМЕСТИТЬ ПартииБУОтходыПрочие
ИЗ
	РегистрНакопления.ПартииТоваровНаСкладахБухгалтерскийУчет КАК ПартииТоваровНаСкладахБухгалтерскийУчетОбороты
		ЛЕВОЕ СОЕДИНЕНИЕ ПризнакиНормируемостиНоменклатуры КАК ПризнакиНормируемостиНоменклатуры
		ПО ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Номенклатура = ПризнакиНормируемостиНоменклатуры.Номенклатура
ГДЕ
	ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Регистратор В
			(ВЫБРАТЬ
				ЗатратыБУ.Регистратор
			ИЗ
				ОтходыПрочие КАК ЗатратыБУ)
	И ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Номенклатура В
			(ВЫБРАТЬ
				ОтходыПрочие.Номенклатура
			ИЗ
				ОтходыПрочие КАК ОтходыПрочие)
	И ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Период МЕЖДУ &НачДата И &КонДата
	И ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.Организация = &Организация
	И ПартииТоваровНаСкладахБухгалтерскийУчетОбороты.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗатратыПартииБУПризнаки.Организация КАК Организация,
	ЗатратыПартииБУПризнаки.Подразделение КАК Подразделение,
	ЗатратыПартииБУПризнаки.СтатьяЗатрат КАК СтатьяЗатрат,
	ЗатратыПартииБУПризнаки.Номенклатура КАК Номенклатура,
	ЗатратыПартииБУПризнаки.КоличествоРасход КАК КоличествоРасход,
	ЗатратыПартииБУПризнаки.СтоимостьРасход КАК СтоимостьРасход,
	ЗатратыПартииБУПризнаки.Номенклатура.НоменклатурнаяГруппа КАК НоменклатураНоменклатурнаяГруппа,
	ЗатратыПартииБУПризнаки.Регистратор,
	ЗатратыПартииБУПризнаки.Нормируемая,
	ВЫБОР
		КОГДА ЗатратыПартииБУПризнаки.Качество.Наименование ПОДОБНО "%Приобретенные%"
			ТОГДА "Покупные"
		ИНАЧЕ "Собственные"
	КОНЕЦ КАК ПокупныеСобственные
ПОМЕСТИТЬ СобственныеПокупныеПодробно
ИЗ
	ЗатратыПартииБУПризнаки КАК ЗатратыПартииБУПризнаки
ГДЕ
	ЗатратыПартииБУПризнаки.Нормируемая = ИСТИНА

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗатратыПартииБУПризнаки.Организация,
	ЗатратыПартииБУПризнаки.Подразделение,
	ЗатратыПартииБУПризнаки.СтатьяЗатрат,
	ЗатратыПартииБУПризнаки.Номенклатура,
	ЗатратыПартииБУПризнаки.КоличествоРасход,
	ЗатратыПартииБУПризнаки.СтоимостьРасход,
	ЗатратыПартииБУПризнаки.Номенклатура.НоменклатурнаяГруппа,
	ЗатратыПартииБУПризнаки.Регистратор,
	ЗатратыПартииБУПризнаки.Нормируемая,
	ВЫБОР
		КОГДА ЗатратыПартииБУПризнаки.Качество.Наименование ПОДОБНО "%Приобретенные%"
			ТОГДА "Покупные"
		ИНАЧЕ "Собственные"
	КОНЕЦ
ИЗ
	ЗатратыПартииБУПризнаки КАК ЗатратыПартииБУПризнаки
ГДЕ
	ЗатратыПартииБУПризнаки.Нормируемая = ЛОЖЬ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ПартииБУОтходыПрочие.Организация,
	ПартииБУОтходыПрочие.Подразделение,
	ПартииБУОтходыПрочие.СтатьяЗатрат,
	ПартииБУОтходыПрочие.Номенклатура,
	-ПартииБУОтходыПрочие.КоличествоРасход,
	-ПартииБУОтходыПрочие.СтоимостьРасход,
	ПартииБУОтходыПрочие.НоменклатураНоменклатурнаяГруппа,
	ПартииБУОтходыПрочие.Регистратор,
	ПартииБУОтходыПрочие.Нормируемая,
	ПартииБУОтходыПрочие.ПокупныеСобственные
ИЗ
	ПартииБУОтходыПрочие КАК ПартииБУОтходыПрочие
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СобственныеПокупные.Организация,
	СобственныеПокупные.СтатьяЗатрат,
	СобственныеПокупные.Номенклатура,
	СобственныеПокупные.Подразделение,
	СобственныеПокупные.КоличествоРасход КАК КоличествоРасход,
	СобственныеПокупные.СтоимостьРасход КАК СтоимостьРасход,
	СобственныеПокупные.НоменклатураНоменклатурнаяГруппа,
	СобственныеПокупные.Регистратор,
	СобственныеПокупные.Нормируемая,
	СобственныеПокупные.ПокупныеСобственные,
	СобственныеПокупные.Номенклатура.ЕдиницаХраненияОстатков КАК ЕдиницаИзмерения
ПОМЕСТИТЬ СобственныеПокупные
ИЗ
	СобственныеПокупныеПодробно КАК СобственныеПокупные
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗатратыПартииБУПризнаки.Организация КАК Организация,
	ЗатратыПартииБУПризнаки.Подразделение КАК Подразделение,
	ЗатратыПартииБУПризнаки.СтатьяЗатрат КАК СтатьяЗатрат,
	ЗатратыПартииБУПризнаки.Регистратор КАК Регистратор,
	ПоступлениеТоваровУслугУслуги.Сумма КАК СуммаИзДокумента,
	ПоступлениеТоваровУслугУслуги.Номенклатура КАК Номенклатура,
	ПоступлениеТоваровУслугУслуги.Количество КАК КоличествоРасход
ПОМЕСТИТЬ ПодрядчикиИПрочееРегистраторы
ИЗ
	ЗатратыПартииБУПризнаки КАК ЗатратыПартииБУПризнаки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг.Услуги КАК ПоступлениеТоваровУслугУслуги
		ПО ЗатратыПартииБУПризнаки.Регистратор = ПоступлениеТоваровУслугУслуги.Ссылка
			И ЗатратыПартииБУПризнаки.Подразделение = ПоступлениеТоваровУслугУслуги.ПодразделениеОрганизации
ГДЕ
	ЗатратыПартииБУПризнаки.Нормируемая ЕСТЬ NULL

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗатратыПартииБУПризнаки.Организация,
	ЗатратыПартииБУПризнаки.Подразделение,
	ЗатратыПартииБУПризнаки.СтатьяЗатрат,
	ЗатратыПартииБУПризнаки.Регистратор,
	ЗатратыПартииБУПризнаки.Сумма,
	ВЫБОР
		КОГДА ЗатратыПартииБУПризнаки.Регистратор ССЫЛКА Документ.АвансовыйОтчет
			ТОГДА ЗатратыПартииБУПризнаки.Регистратор.НазначениеАванса
		ИНАЧЕ ЗатратыПартииБУПризнаки.Регистратор
	КОНЕЦ,
	ЕСТЬNULL(ЗатратыПартииБУПризнаки.КоличествоРасход, 0)
ИЗ
	ЗатратыПартииБУПризнаки КАК ЗатратыПартииБУПризнаки
ГДЕ
	ЗатратыПартииБУПризнаки.Нормируемая ЕСТЬ NULL
	И НЕ ЗатратыПартииБУПризнаки.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПодрядчикиИПрочее.Организация,
	ПодрядчикиИПрочее.Подразделение,
	ПодрядчикиИПрочее.СтатьяЗатрат,
	ВЫБОР
		КОГДА ПодрядчикиИПрочее.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
			ТОГДА "Подрядчики"
		ИНАЧЕ "Прочее"
	КОНЕЦ КАК Подгруппа,
	ПодрядчикиИПрочее.СуммаИзДокумента КАК СуммаИзДокумента,
	ПодрядчикиИПрочее.Номенклатура,
	ПодрядчикиИПрочее.Регистратор,
	ЕСТЬNULL(ПризнакиНормируемостиНоменклатуры.Нормируемая, ЛОЖЬ) КАК Нормируемая,
	ПодрядчикиИПрочее.КоличествоРасход,
	ВЫБОР
		КОГДА ПодрядчикиИПрочее.Номенклатура ССЫЛКА Справочник.Номенклатура
			ТОГДА ВЫБОР
					КОГДА ПодрядчикиИПрочее.Номенклатура.Наименование ПОДОБНО "транспортировка газа%"
						ТОГДА "м3"
					ИНАЧЕ ПодрядчикиИПрочее.Номенклатура.ЕдиницаХраненияОстатков
				КОНЕЦ
		ИНАЧЕ ""
	КОНЕЦ КАК ЕдиницаИзмерения
ПОМЕСТИТЬ ПодрядчикиИПрочее
ИЗ
	ПодрядчикиИПрочееРегистраторы КАК ПодрядчикиИПрочее
		ЛЕВОЕ СОЕДИНЕНИЕ ПризнакиНормируемостиНоменклатуры КАК ПризнакиНормируемостиНоменклатуры
		ПО ПодрядчикиИПрочее.Номенклатура = ПризнакиНормируемостиНоменклатуры.Номенклатура
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СобственныеПокупные.Организация,
	СобственныеПокупные.СтатьяЗатрат,
	СобственныеПокупные.Номенклатура,
	ВЫБОР
		КОГДА СобственныеПокупные.Номенклатура ССЫЛКА Справочник.Номенклатура
			ТОГДА СобственныеПокупные.КоличествоРасход
		ИНАЧЕ 0
	КОНЕЦ КАК КоличествоРасход,
	СобственныеПокупные.СтоимостьРасход,
	ВЫБОР
		КОГДА СобственныеПокупные.НоменклатураНоменклатурнаяГруппа = ЗНАЧЕНИЕ(Справочник.НоменклатурныеГруппы.ПустаяСсылка)
			ТОГДА "Вспомогательные материалы"
		ИНАЧЕ СобственныеПокупные.НоменклатураНоменклатурнаяГруппа
	КОНЕЦ КАК Подгруппа,
	СобственныеПокупные.Подразделение,
	СобственныеПокупные.Регистратор КАК Регистратор,
	СобственныеПокупные.Нормируемая КАК Нормируемая,
	СобственныеПокупные.ПокупныеСобственные,
	СобственныеПокупные.ЕдиницаИзмерения
ПОМЕСТИТЬ СобственныеПокупныеПодрядчикиИПрочее
ИЗ
	СобственныеПокупные КАК СобственныеПокупные

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ПодрядчикиИПрочее.Организация,
	ПодрядчикиИПрочее.СтатьяЗатрат,
	ПодрядчикиИПрочее.Номенклатура,
	ПодрядчикиИПрочее.КоличествоРасход,
	ПодрядчикиИПрочее.СуммаИзДокумента,
	ПодрядчикиИПрочее.Подгруппа,
	ПодрядчикиИПрочее.Подразделение,
	ПодрядчикиИПрочее.Регистратор,
	ПодрядчикиИПрочее.Нормируемая,
	"Покупные",
	ПодрядчикиИПрочее.ЕдиницаИзмерения
ИЗ
	ПодрядчикиИПрочее КАК ПодрядчикиИПрочее
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВыпускПродукции.Организация,
	ВыпускПродукции.Подразделение,
	ВыпускПродукции.Продукция,
	ВыпускПродукции.КоличествоОборот,
	ВыпускПродукции.СтоимостьОборот,
	ВЫБОР
		КОГДА ВыпускПродукции.КоличествоОборот <> 0
			ТОГДА ВыпускПродукции.СтоимостьОборот / ВыпускПродукции.КоличествоОборот
		ИНАЧЕ 0
	КОНЕЦ КАК СтоимостьЗаЕдиницу
ПОМЕСТИТЬ ВыпускПродукции
ИЗ
	(ВЫБРАТЬ
		ВыпускПродукцииБухгалтерскийУчетОбороты.Организация КАК Организация,
		ВыпускПродукцииБухгалтерскийУчетОбороты.Подразделение КАК Подразделение,
		&СтальВсего КАК Продукция,
		СУММА(ВыпускПродукцииБухгалтерскийУчетОбороты.КоличествоОборот) КАК КоличествоОборот,
		СУММА(ВыпускПродукцииБухгалтерскийУчетОбороты.СтоимостьОборот) КАК СтоимостьОборот
	ИЗ
		РегистрНакопления.ВыпускПродукцииБухгалтерскийУчет.Обороты(
				&НачДата,
				&КонДата,
				,
				Организация = &Организация
					И Подразделение В ИЕРАРХИИ (&Подразделение)
					И Продукция В
						(ВЫБРАТЬ
							СпособыРаспределения.Продукция
						ИЗ
							СпособыРаспределения КАК СпособыРаспределения)) КАК ВыпускПродукцииБухгалтерскийУчетОбороты
	ГДЕ
		ВЫБОР
				КОГДА ВыпускПродукцииБухгалтерскийУчетОбороты.НоменклатурнаяГруппа.Наименование ПОДОБНО "Металлопродукция"
					ТОГДА ИСТИНА
				КОГДА ВыпускПродукцииБухгалтерскийУчетОбороты.НоменклатурнаяГруппа.Наименование ПОДОБНО "Полуфабрикаты"
					ТОГДА ИСТИНА
				ИНАЧЕ ЛОЖЬ
			КОНЕЦ
	
	СГРУППИРОВАТЬ ПО
		ВыпускПродукцииБухгалтерскийУчетОбороты.Организация,
		ВыпускПродукцииБухгалтерскийУчетОбороты.Подразделение) КАК ВыпускПродукции
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Организация,
	ВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Подразделение,
	ВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Продукция,
	ВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.КоличествоОстаток КАК ОстатокНаНачало,
	0 КАК ОстатокНаКонец
ПОМЕСТИТЬ ВыпускПродукцииНаработка
ИЗ
	РегистрНакопления.ВыпускПродукцииНаработкаБухгалтерскийУчет.Остатки(
			&НачДата,
			Организация = &Организация
				И Подразделение В ИЕРАРХИИ (&Подразделение)
				И Продукция В
					(ВЫБРАТЬ
						СпособыРаспределения.Продукция
					ИЗ
						СпособыРаспределения КАК СпособыРаспределения)) КАК ВыпускПродукцииНаработкаБухгалтерскийУчетОстатки

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Организация,
	ВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Подразделение,
	ВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Продукция,
	NULL,
	ВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.КоличествоОстаток
ИЗ
	РегистрНакопления.ВыпускПродукцииНаработкаБухгалтерскийУчет.Остатки(
			ДОБАВИТЬКДАТЕ(&КонДата, СЕКУНДА, 1),
			Организация = &Организация
				И Подразделение В ИЕРАРХИИ (&Подразделение)
				И Продукция В
					(ВЫБРАТЬ
						СпособыРаспределения.Продукция
					ИЗ
						СпособыРаспределения КАК СпособыРаспределения)) КАК ВыпускПродукцииНаработкаБухгалтерскийУчетОстатки
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	УслугиЦеховПодгруппы.Организация,
	УслугиЦеховПодгруппы.ПодГруппа,
	УслугиЦеховПодгруппы.Затрата,
	СУММА(УслугиЦеховПодгруппы.Стоимость) КАК Стоимость,
	УслугиЦеховПодгруппы.ПодразделениеПолучатель,
	УслугиЦеховПодгруппы.СтатьяЗатратПолучатель,
	СУММА(УслугиЦеховПодгруппы.Количество) КАК Количество
ПОМЕСТИТЬ УслугиЦеховПодгруппы
ИЗ
	(ВЫБРАТЬ
		УслугиЦехов.Организация КАК Организация,
		ВЫБОР
			КОГДА УслугиЦехов.Продукция.Наименование ПОДОБНО "Электроэнергия покупная ТЭЦ%"
				ТОГДА "Энергозатраты"
			КОГДА УслугиЦехов.Продукция.Наименование ПОДОБНО "Газ природный%"
				ТОГДА "Энергозатраты"
			КОГДА УслугиЦехов.Продукция.Наименование ПОДОБНО "Транспортировка природного газа%"
				ТОГДА "Энергозатраты"
			КОГДА УслугиЦехов.Продукция.Наименование ПОДОБНО "Пар ТЭЦ%"
				ТОГДА "Энергозатраты"
			КОГДА УслугиЦехов.Продукция.Наименование ПОДОБНО "Транспортировка пара ТЭЦ%"
				ТОГДА "Энергозатраты"
			КОГДА УслугиЦехов.Продукция.Наименование ПОДОБНО "Кислород  газообразный технический%"
				ТОГДА "Энергозатраты"
			КОГДА УслугиЦехов.Продукция.Наименование ПОДОБНО "Водоотведение%"
				ТОГДА "Энергозатраты"
			КОГДА УслугиЦехов.Продукция.Наименование ПОДОБНО "Водоснабжение%"
				ТОГДА "Энергозатраты"
			ИНАЧЕ "Услуги цехов"
		КОНЕЦ КАК ПодГруппа,
		ВЫБОР
			КОГДА УслугиЦехов.Подразделение.Наименование ПОДОБНО "Передача питьевой воды%"
				ТОГДА ВЫБОР
						КОГДА УслугиЦехов.Продукция.Наименование ПОДОБНО "Водоснабжение транспортировка%"
							ТОГДА "Вода питьевая услуги ЦВС"
						ИНАЧЕ "Вода питьевая"
					КОНЕЦ
			КОГДА УслугиЦехов.Подразделение.Наименование ПОДОБНО "Передача стоков%"
				ТОГДА ВЫБОР
						КОГДА УслугиЦехов.Продукция.Наименование ПОДОБНО "Водоотведение транспортировка"
							ТОГДА "Услуги ЦВС"
						ИНАЧЕ "Стоки"
					КОНЕЦ
			КОГДА УслугиЦехов.Продукция.Наименование ПОДОБНО "Газ природный%"
				ТОГДА УслугиЦехов.Продукция.Наименование
			КОГДА УслугиЦехов.Продукция.Наименование ПОДОБНО "Транспортировка природного газа%"
				ТОГДА "услуги ГЦ"
			ИНАЧЕ УслугиЦехов.Подразделение
		КОНЕЦ КАК Затрата,
		УслугиЦехов.Количество КАК Количество,
		УслугиЦехов.Стоимость КАК Стоимость,
		УслугиЦехов.ПодразделениеПолучатель КАК ПодразделениеПолучатель,
		УслугиЦехов.СтатьяЗатратПолучатель КАК СтатьяЗатратПолучатель
	ИЗ
		УслугиЦехов КАК УслугиЦехов) КАК УслугиЦеховПодгруппы

СГРУППИРОВАТЬ ПО
	УслугиЦеховПодгруппы.Организация,
	УслугиЦеховПодгруппы.ПодГруппа,
	УслугиЦеховПодгруппы.Затрата,
	УслугиЦеховПодгруппы.ПодразделениеПолучатель,
	УслугиЦеховПодгруппы.СтатьяЗатратПолучатель
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СобственныеПокупныеПодрядчикиИПрочее.Организация КАК Организация,
	СобственныеПокупныеПодрядчикиИПрочее.СтатьяЗатрат КАК СтатьяЗатрат,
	СобственныеПокупныеПодрядчикиИПрочее.Номенклатура КАК Номенклатура,
	СобственныеПокупныеПодрядчикиИПрочее.КоличествоРасход КАК КоличествоРасход,
	СобственныеПокупныеПодрядчикиИПрочее.СтоимостьРасход КАК СтоимостьРасход,
	СобственныеПокупныеПодрядчикиИПрочее.Подгруппа КАК Подгруппа,
	СобственныеПокупныеПодрядчикиИПрочее.Подразделение КАК Подразделение,
	СобственныеПокупныеПодрядчикиИПрочее.Регистратор,
	СобственныеПокупныеПодрядчикиИПрочее.Нормируемая,
	СобственныеПокупныеПодрядчикиИПрочее.ПокупныеСобственные,
	СобственныеПокупныеПодрядчикиИПрочее.ЕдиницаИзмерения
ПОМЕСТИТЬ ЗатратыИУслугиЦехов
ИЗ
	СобственныеПокупныеПодрядчикиИПрочее КАК СобственныеПокупныеПодрядчикиИПрочее

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	УслугиЦеховПодгруппы.Организация,
	УслугиЦеховПодгруппы.СтатьяЗатратПолучатель,
	УслугиЦеховПодгруппы.Затрата,
	УслугиЦеховПодгруппы.Количество,
	УслугиЦеховПодгруппы.Стоимость,
	УслугиЦеховПодгруппы.ПодГруппа,
	УслугиЦеховПодгруппы.ПодразделениеПолучатель,
	NULL,
	NULL,
	NULL,
	NULL
ИЗ
	УслугиЦеховПодгруппы КАК УслугиЦеховПодгруппы
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗатратыИУслугиЦехов.Организация,
	ЗатратыИУслугиЦехов.СтатьяЗатрат,
	СУММА(ЗатратыИУслугиЦехов.СтоимостьРасход) КАК СтоимостьРасход
ПОМЕСТИТЬ ИтогоЗатратыПоСтатьям
ИЗ
	ЗатратыИУслугиЦехов КАК ЗатратыИУслугиЦехов

СГРУППИРОВАТЬ ПО
	ЗатратыИУслугиЦехов.Организация,
	ЗатратыИУслугиЦехов.СтатьяЗатрат
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БазоваяВыборкаЗнВП.Организация,
	БазоваяВыборкаЗнВП.СтатьяЗатрат,
	СУММА(БазоваяВыборкаЗнВП.СуммаОборот) КАК СуммаОборот
ПОМЕСТИТЬ ИтогоДаноПоСтатьям
ИЗ
	БазоваяВыборкаЗнВП КАК БазоваяВыборкаЗнВП
ГДЕ
	БазоваяВыборкаЗнВП.СтатьяЗатрат В(&СтатьиЗатратСодержаниеОхранаТрудаПрочиеРемонтыТранспорт)

СГРУППИРОВАТЬ ПО
	БазоваяВыборкаЗнВП.Организация,
	БазоваяВыборкаЗнВП.СтатьяЗатрат
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПодгонкаРасчетК.Организация,
	ПодгонкаРасчетК.СтатьяЗатрат,
	ПодгонкаРасчетК.Разница,
	ПодгонкаРасчетК.СуммаДано,
	ПодгонкаРасчетК.СуммаЗатрат,
	ПодгонкаРасчетК.СуммаДано - ПодгонкаРасчетК.СуммаЗатрат КАК КУменьшения
ПОМЕСТИТЬ ПодгонкаРасчетК
ИЗ
	(ВЫБРАТЬ
		ПодгонкаРасчетРазницы.Организация КАК Организация,
		ПодгонкаРасчетРазницы.СтатьяЗатрат КАК СтатьяЗатрат,
		СУММА(ПодгонкаРасчетРазницы.Разница) КАК Разница,
		СУММА(ПодгонкаРасчетРазницы.СуммаДано) КАК СуммаДано,
		СУММА(ПодгонкаРасчетРазницы.СтоимостьРасход) КАК СуммаЗатрат
	ИЗ
		(ВЫБРАТЬ
			ИтогоДаноПоСтатьям.Организация КАК Организация,
			ИтогоДаноПоСтатьям.СтатьяЗатрат КАК СтатьяЗатрат,
			ИтогоДаноПоСтатьям.СуммаОборот КАК Разница,
			ИтогоДаноПоСтатьям.СуммаОборот КАК СуммаДано,
			0 КАК СтоимостьРасход
		ИЗ
			ИтогоДаноПоСтатьям КАК ИтогоДаноПоСтатьям
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			ИтогоЗатратыПоСтатьям.Организация,
			ИтогоЗатратыПоСтатьям.СтатьяЗатрат,
			-ИтогоЗатратыПоСтатьям.СтоимостьРасход,
			0,
			ИтогоЗатратыПоСтатьям.СтоимостьРасход
		ИЗ
			ИтогоЗатратыПоСтатьям КАК ИтогоЗатратыПоСтатьям) КАК ПодгонкаРасчетРазницы
	
	СГРУППИРОВАТЬ ПО
		ПодгонкаРасчетРазницы.Организация,
		ПодгонкаРасчетРазницы.СтатьяЗатрат) КАК ПодгонкаРасчетК
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗатратыИУслугиЦехов.Организация,
	ЗатратыИУслугиЦехов.СтатьяЗатрат,
	ЗатратыИУслугиЦехов.Номенклатура,
	ЗатратыИУслугиЦехов.КоличествоРасход КАК Количество,
	ЗатратыИУслугиЦехов.СтоимостьРасход КАК Стоимость,
	ЗатратыИУслугиЦехов.Подгруппа,
	ЗатратыИУслугиЦехов.Подразделение,
	ЗатратыИУслугиЦехов.Регистратор,
	ЗатратыИУслугиЦехов.Нормируемая,
	ЗатратыИУслугиЦехов.ПокупныеСобственные,
	ЗатратыИУслугиЦехов.ЕдиницаИзмерения
ПОМЕСТИТЬ ЗатратыИУслугиЦеховПравильные
ИЗ
	ЗатратыИУслугиЦехов КАК ЗатратыИУслугиЦехов
		ЛЕВОЕ СОЕДИНЕНИЕ ПодгонкаРасчетК КАК ПодгонкаРасчетК
		ПО ЗатратыИУслугиЦехов.Организация = ПодгонкаРасчетК.Организация
			И ЗатратыИУслугиЦехов.СтатьяЗатрат = ПодгонкаРасчетК.СтатьяЗатрат
			И (ПодгонкаРасчетК.КУменьшения <> 0)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПодгонкаРасчетК.Организация,
	ПодгонкаРасчетК.СтатьяЗатрат,
	ПодгонкаРасчетК.Разница,
	ПодгонкаРасчетК.СуммаДано,
	ПодгонкаРасчетК.СуммаЗатрат,
	ПодгонкаРасчетК.КУменьшения
ПОМЕСТИТЬ НеХватаетРасшифровки
ИЗ
	ПодгонкаРасчетК КАК ПодгонкаРасчетК
ГДЕ
	ПодгонкаРасчетК.КУменьшения <> 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПравильныйОстаток.Организация,
	ПравильныйОстаток.СтатьяЗатрат,
	ПодразделенияПоПродукции.Подразделение,
	СУММА(ПравильныйОстаток.Стоимость) КАК Стоимость,
	ПравильныйОстаток.Номенклатура,
	СУММА(ПравильныйОстаток.Количество) КАК Количество,
	ПравильныйОстаток.Подгруппа,
	ПравильныйОстаток.Регистратор,
	ПравильныйОстаток.Нормируемая,
	ПравильныйОстаток.ПокупныеСобственные,
	ПравильныйОстаток.ЕдиницаИзмерения
ПОМЕСТИТЬ ПравильныйОстатокРаспределения
ИЗ
	(ВЫБРАТЬ
		Р_ПоПодразделениям.Организация КАК Организация,
		Р_ПоПодразделениям.СтатьяЗатрат КАК СтатьяЗатрат,
		Р_ПоПодразделениям.Подразделение КАК Подразделение,
		Р_ПоПодразделениям.Стоимость КАК Стоимость,
		Р_ПоПодразделениям.Номенклатура КАК Номенклатура,
		Р_ПоПодразделениям.Количество КАК Количество,
		Р_ПоПодразделениям.Подгруппа КАК Подгруппа,
		Р_ПоПодразделениям.Регистратор КАК Регистратор,
		Р_ПоПодразделениям.Нормируемая КАК Нормируемая,
		Р_ПоПодразделениям.ПокупныеСобственные КАК ПокупныеСобственные,
		Р_ПоПодразделениям.ЕдиницаИзмерения КАК ЕдиницаИзмерения
	ИЗ
		ЗатратыИУслугиЦеховПравильные КАК Р_ПоПодразделениям
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		НеХватаетРасшифровки.Организация,
		НеХватаетРасшифровки.СтатьяЗатрат,
		NULL,
		НеХватаетРасшифровки.Разница,
		NULL,
		0,
		"Усреднение партий",
		NULL,
		NULL,
		NULL,
		NULL
	ИЗ
		НеХватаетРасшифровки КАК НеХватаетРасшифровки) КАК ПравильныйОстаток
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			БазоваяВыборкаЗнВП.Организация КАК Организация,
			МАКСИМУМ(БазоваяВыборкаЗнВП.Подразделение) КАК Подразделение
		ИЗ
			БазоваяВыборкаЗнВП КАК БазоваяВыборкаЗнВП
		
		СГРУППИРОВАТЬ ПО
			БазоваяВыборкаЗнВП.Организация) КАК ПодразделенияПоПродукции
		ПО ПравильныйОстаток.Организация = ПодразделенияПоПродукции.Организация

СГРУППИРОВАТЬ ПО
	ПравильныйОстаток.Организация,
	ПравильныйОстаток.СтатьяЗатрат,
	ПодразделенияПоПродукции.Подразделение,
	ПравильныйОстаток.Номенклатура,
	ПравильныйОстаток.Подгруппа,
	ПравильныйОстаток.Регистратор,
	ПравильныйОстаток.Нормируемая,
	ПравильныйОстаток.ПокупныеСобственные,
	ПравильныйОстаток.ЕдиницаИзмерения
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗатратыНаВыпуск.Организация,
	ЗатратыНаВыпуск.Подразделение,
	ЗатратыНаВыпуск.Продукция,
	ЗатратыНаВыпуск.СтатьяЗатрат,
	&СтальВсего КАК Затрата,
	СУММА(ЗатратыНаВыпуск.КоличествоОборот) КАК КоличествоОборот,
	СУММА(ЗатратыНаВыпуск.СуммаОборот) КАК СуммаОборот,
	ЗатратыНаВыпуск.НоменклатурнаяГруппа
ПОМЕСТИТЬ БракСтальногоЛитья
ИЗ
	ЗатратыНаВыпускПлюсНаработка КАК ЗатратыНаВыпуск
ГДЕ
	ЗатратыНаВыпуск.Продукция.Наименование ПОДОБНО "Брак%"

СГРУППИРОВАТЬ ПО
	ЗатратыНаВыпуск.Организация,
	ЗатратыНаВыпуск.Подразделение,
	ЗатратыНаВыпуск.Продукция,
	ЗатратыНаВыпуск.СтатьяЗатрат,
	ЗатратыНаВыпуск.НоменклатурнаяГруппа
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БракСтальногоЛитья.Организация,
	БракСтальногоЛитья.Подразделение,
	БракСтальногоЛитья.Продукция,
	СУММА(БракСтальногоЛитья.СуммаОборот) КАК СуммаОборот,
	БракСтальногоЛитья.НоменклатурнаяГруппа
ПОМЕСТИТЬ БракСтальногоЛитьяСумма
ИЗ
	БракСтальногоЛитья КАК БракСтальногоЛитья
ГДЕ
	БракСтальногоЛитья.СтатьяЗатрат = &Отходы

СГРУППИРОВАТЬ ПО
	БракСтальногоЛитья.Организация,
	БракСтальногоЛитья.Подразделение,
	БракСтальногоЛитья.Продукция,
	БракСтальногоЛитья.НоменклатурнаяГруппа
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БракСтальногоЛитья.Организация,
	БракСтальногоЛитья.Подразделение,
	БракСтальногоЛитья.Продукция,
	БракСтальногоЛитья.СтатьяЗатрат,
	БракСтальногоЛитья.Затрата,
	БракСтальногоЛитья.КоличествоОборот,
	БракСтальногоЛитья.СуммаОборот,
	БракСтальногоЛитья.НоменклатурнаяГруппа
ПОМЕСТИТЬ БракСтальногоЛитьяПоПродукциям
ИЗ
	БракСтальногоЛитья КАК БракСтальногоЛитья
ГДЕ
	БракСтальногоЛитья.СтатьяЗатрат = &Отходы
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БракСтальногоЛитьяПоПродукциям.Организация,
	БракСтальногоЛитьяПоПродукциям.Подразделение,
	СУММА(БракСтальногоЛитьяПоПродукциям.КоличествоОборот) КАК КоличествоОборот,
	БракСтальногоЛитьяПоПродукциям.СтатьяЗатрат,
	БракСтальногоЛитьяПоПродукциям.НоменклатурнаяГруппа
ПОМЕСТИТЬ БракСтальногоЛитьяКоличество
ИЗ
	БракСтальногоЛитьяПоПродукциям КАК БракСтальногоЛитьяПоПродукциям

СГРУППИРОВАТЬ ПО
	БракСтальногоЛитьяПоПродукциям.Организация,
	БракСтальногоЛитьяПоПродукциям.Подразделение,
	БракСтальногоЛитьяПоПродукциям.СтатьяЗатрат,
	БракСтальногоЛитьяПоПродукциям.НоменклатурнаяГруппа
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БракСтальногоЛитьяПоПродукциям.Организация,
	ПодразделенияПоПродукции.Подразделение,
	БракСтальногоЛитьяПоПродукциям.Продукция КАК Затрата,
	&Отходы КАК СтатьяЗатрат,
	БракСтальногоЛитьяПоПродукциям.Затрата КАК Продукция,
	БракСтальногоЛитьяПоПродукциям.КоличествоОборот КАК КоличествоБрака,
	БракСтальногоЛитьяПоПродукциям.СуммаОборот,
	БракСтальногоЛитьяПоПродукциям.НоменклатурнаяГруппа,
	БракСтальногоЛитьяПоПродукциям.СуммаОборот КАК СуммаБрака,
	БракСтальногоЛитьяПоПродукциям.Продукция.НоменклатурнаяГруппа КАК НоменклатурнаяГруппаЗатрат,
	ИСТИНА КАК Нормируемая,
	"Собственные" КАК ПокупныеСобственные,
	БракСтальногоЛитьяПоПродукциям.Продукция.ЕдиницаХраненияОстатков КАК ЕдиницаИзмерения
ПОМЕСТИТЬ Брак
ИЗ
	БракСтальногоЛитьяПоПродукциям КАК БракСтальногоЛитьяПоПродукциям
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			К1.Организация КАК Организация,
			МАКСИМУМ(К1.Подразделение) КАК Подразделение
		ИЗ
			БазоваяВыборкаЗнВП КАК К1
		
		СГРУППИРОВАТЬ ПО
			К1.Организация) КАК ПодразделенияПоПродукции
		ПО (ИСТИНА)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Брак.Организация,
	Брак.Подразделение,
	Брак.Продукция,
	Брак.Затрата.ЕдиницаХраненияОстатков КАК ЕдиницаХраненияОстатков,
	СУММА(Брак.КоличествоБрака) КАК КоличествоБрака,
	СУММА(Брак.СуммаБрака) КАК СуммаБрака
ПОМЕСТИТЬ БракИтого
ИЗ
	Брак КАК Брак

СГРУППИРОВАТЬ ПО
	Брак.Организация,
	Брак.Подразделение,
	Брак.Продукция,
	Брак.Затрата.ЕдиницаХраненияОстатков
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БазоваяВыборкаЗнВП.СтатьяЗатрат КАК СтатьяЗатрат,
	БазоваяВыборкаЗнВП.Затрата КАК Номенклатура,
	БазоваяВыборкаЗнВП.СуммаОборот КАК СуммаОборот,
	БазоваяВыборкаЗнВП.Организация КАК Организация,
	БазоваяВыборкаЗнВП.Подразделение КАК ПодразделениеОрганизации,
	БазоваяВыборкаЗнВП.КоличествоОборот КАК КоличествоЗатраты,
	БазоваяВыборкаЗнВП.СуммаОборот КАК СуммаЗатраты,
	БазоваяВыборкаЗнВП.Продукция КАК Продукция,
	БазоваяВыборкаЗнВП.Нормируемая,
	БазоваяВыборкаЗнВП.ЗатратаЕдиницаХраненияОстатков
ПОМЕСТИТЬ ОтходыБезЛома
ИЗ
	БазоваяВыборкаЗнВП КАК БазоваяВыборкаЗнВП
ГДЕ
	БазоваяВыборкаЗнВП.СтатьяЗатрат = &Отходы
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БракИтого.Организация,
	БракИтого.Подразделение,
	БракИтого.Продукция,
	БракИтого.КоличествоБрака,
	БракИтого.СуммаБрака,
	&ЛомБрак КАК Затрата,
	ИСТИНА КАК Нормируемая,
	&Отходы КАК СтатьяЗатрат,
	БракИтого.ЕдиницаХраненияОстатков
ПОМЕСТИТЬ ЛомБрак
ИЗ
	БракИтого КАК БракИтого
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Отходы.СтатьяЗатрат,
	Отходы.Номенклатура,
	Отходы.СуммаОборот,
	Отходы.Организация,
	Отходы.ПодразделениеОрганизации,
	Отходы.КоличествоЗатраты,
	Отходы.СуммаЗатраты,
	Отходы.Продукция,
	Отходы.Нормируемая,
	Отходы.ЗатратаЕдиницаХраненияОстатков
ПОМЕСТИТЬ Отходы
ИЗ
	ОтходыБезЛома КАК Отходы

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЛомБрак.СтатьяЗатрат,
	ЛомБрак.Затрата,
	-ЛомБрак.СуммаБрака,
	ЛомБрак.Организация,
	ЛомБрак.Подразделение,
	-ЛомБрак.КоличествоБрака,
	-ЛомБрак.СуммаБрака,
	ЛомБрак.Продукция,
	ЛомБрак.Нормируемая,
	ЛомБрак.ЕдиницаХраненияОстатков
ИЗ
	ЛомБрак КАК ЛомБрак
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БракСтальногоЛитья.Организация,
	ПодразделенияПоПродукции.Подразделение,
	&СтатьяПотериОтБрака КАК СтатьяЗатрат,
	БракСтальногоЛитья.Затрата КАК Продукция,
	СУММА(ВЫБОР
			КОГДА БракСтальногоЛитья.КоличествоОборот < 0
				ТОГДА БракСтальногоЛитья.КоличествоОборот
			ИНАЧЕ 0
		КОНЕЦ) КАК КоличествоОборот,
	-СУММА(БракСтальногоЛитья.СуммаОборот) КАК СуммаОборот,
	БракСтальногоЛитья.НоменклатурнаяГруппа,
	"Относимого на другие цехи (-)" КАК Затрата,
	БракСтальногоЛитья.Продукция.НоменклатурнаяГруппа КАК НоменклатурнаяГруппаЗатрат,
	БракСтальногоЛитья.Подразделение КАК Подразделение1,
	БракСтальногоЛитья.Продукция КАК Продукция1
ПОМЕСТИТЬ ПотериОтБракаОтносимый
ИЗ
	БракСтальногоЛитья КАК БракСтальногоЛитья
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			К1.Организация КАК Организация,
			МАКСИМУМ(К1.Подразделение) КАК Подразделение
		ИЗ
			БазоваяВыборкаЗнВП КАК К1
		
		СГРУППИРОВАТЬ ПО
			К1.Организация) КАК ПодразделенияПоПродукции
		ПО (ИСТИНА)
ГДЕ
	БракСтальногоЛитья.НоменклатурнаяГруппа.Наименование ПОДОБНО "Брак по металлу"

СГРУППИРОВАТЬ ПО
	БракСтальногоЛитья.Организация,
	ПодразделенияПоПродукции.Подразделение,
	БракСтальногоЛитья.Затрата,
	БракСтальногоЛитья.НоменклатурнаяГруппа,
	БракСтальногоЛитья.Продукция.НоменклатурнаяГруппа,
	БракСтальногоЛитья.Подразделение,
	БракСтальногоЛитья.Продукция
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВыпускПродукцииБухгалтерскийУчет.Организация,
	ВыпускПродукцииБухгалтерскийУчет.Подразделение КАК ПодразделениеОтправитель,
	&СтальВсего КАК Продукция,
	СУММА(ВыпускПродукцииБухгалтерскийУчет.Количество) КАК Количество,
	СУММА(ВыпускПродукцииБухгалтерскийУчет.Стоимость) КАК Стоимость,
	ВыпускПродукцииБухгалтерскийУчет.ПодразделениеПолучатель КАК Подразделение,
	ВыпускПродукцииБухгалтерскийУчет.СтатьяЗатратПолучатель КАК СтатьяЗатрат,
	"Выявленного в др.цехах и складах (+)" КАК Затрата,
	ВыпускПродукцииБухгалтерскийУчет.Продукция.НоменклатурнаяГруппа КАК НоменклатурнаяГруппаЗатрат,
	ВыпускПродукцииБухгалтерскийУчет.Подразделение КАК Подразделение1,
	ВыпускПродукцииБухгалтерскийУчет.Продукция КАК Продукция1
ПОМЕСТИТЬ ПотериОтБракаВыявленный
ИЗ
	РегистрНакопления.ВыпускПродукцииБухгалтерскийУчет КАК ВыпускПродукцииБухгалтерскийУчет
ГДЕ
	ВыпускПродукцииБухгалтерскийУчет.Период МЕЖДУ &НачДата И &КонДата
	И ВыпускПродукцииБухгалтерскийУчет.ПодразделениеПолучатель В ИЕРАРХИИ(&Подразделение)
	И ВыпускПродукцииБухгалтерскийУчет.Активность
	И ВыпускПродукцииБухгалтерскийУчет.СтатьяЗатратПолучатель.Наименование ПОДОБНО "Потери от брака%"
	И ВыпускПродукцииБухгалтерскийУчет.Подразделение.Родитель <> ВыпускПродукцииБухгалтерскийУчет.ПодразделениеПолучатель.Родитель

СГРУППИРОВАТЬ ПО
	ВыпускПродукцииБухгалтерскийУчет.Организация,
	ВыпускПродукцииБухгалтерскийУчет.Подразделение,
	ВыпускПродукцииБухгалтерскийУчет.КодОперации,
	ВыпускПродукцииБухгалтерскийУчет.ПодразделениеПолучатель,
	ВыпускПродукцииБухгалтерскийУчет.СтатьяЗатратПолучатель,
	ВыпускПродукцииБухгалтерскийУчет.Продукция.НоменклатурнаяГруппа,
	ВыпускПродукцииБухгалтерскийУчет.Продукция,
	ВыпускПродукцииБухгалтерскийУчет.Подразделение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПотериОтБракаОтносимый.Организация,
	ПотериОтБракаОтносимый.Подразделение,
	ПотериОтБракаОтносимый.СтатьяЗатрат,
	ПотериОтБракаОтносимый.Продукция,
	ПотериОтБракаОтносимый.КоличествоОборот,
	ПотериОтБракаОтносимый.СуммаОборот,
	ПотериОтБракаОтносимый.Затрата,
	ПотериОтБракаОтносимый.НоменклатурнаяГруппаЗатрат КАК НоменклатурнаяГруппаЗатрат,
	ПотериОтБракаОтносимый.Продукция1,
	ПотериОтБракаОтносимый.Подразделение1
ПОМЕСТИТЬ ПотериОтБрака
ИЗ
	ПотериОтБракаОтносимый КАК ПотериОтБракаОтносимый

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ПотериОтБракаВыявленный.Организация,
	ПотериОтБракаВыявленный.Подразделение,
	ПотериОтБракаВыявленный.СтатьяЗатрат,
	ПотериОтБракаВыявленный.Продукция,
	ПотериОтБракаВыявленный.Количество,
	ПотериОтБракаВыявленный.Стоимость,
	ПотериОтБракаВыявленный.Затрата,
	ПотериОтБракаВыявленный.НоменклатурнаяГруппаЗатрат,
	ПотериОтБракаВыявленный.Продукция1,
	ПотериОтБракаВыявленный.Подразделение1
ИЗ
	ПотериОтБракаВыявленный КАК ПотериОтБракаВыявленный
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПотериОтБрака.Организация,
	ПотериОтБрака.Подразделение,
	ПотериОтБрака.Продукция,
	-ПотериОтБрака.КоличествоОборот КАК КоличествоОборот,
	-ПотериОтБрака.СуммаОборот КАК СуммаОборот,
	ПотериОтБрака.Подразделение1 КАК Затрата,
	ПотериОтБрака.НоменклатурнаяГруппаЗатрат,
	ИСТИНА КАК Нормируемая,
	ПотериОтБрака.СтатьяЗатрат КАК СтатьяЗатрат,
	БракИтого.ЕдиницаХраненияОстатков
ПОМЕСТИТЬ ЛомПотериОтБрака
ИЗ
	ПотериОтБрака КАК ПотериОтБрака,
	БракИтого КАК БракИтого
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БазоваяВыборкаЗнВП.Организация,
	БазоваяВыборкаЗнВП.Подразделение,
	&СтальВсего КАК Продукция,
	БазоваяВыборкаЗнВП.СтатьяЗатрат,
	БазоваяВыборкаЗнВП.Затрата,
	БазоваяВыборкаЗнВП.КоличествоОборот,
	БазоваяВыборкаЗнВП.СуммаОборот,
	БазоваяВыборкаЗнВП.НоменклатурнаяГруппаЗатрат,
	NULL КАК Регистратор,
	БазоваяВыборкаЗнВП.Нормируемая КАК Нормируемая,
	NULL КАК ПокупныеСобственные,
	БазоваяВыборкаЗнВП.Затрата.ЕдиницаХраненияОстатков КАК ЕдиницаИзмерения,
	NULL КАК Раздел,
	NULL КАК Группа
ПОМЕСТИТЬ БазоваяВыборкаЗнВПОтходы
ИЗ
	БазоваяВыборкаЗнВП КАК БазоваяВыборкаЗнВП
ГДЕ
	БазоваяВыборкаЗнВП.СтатьяЗатрат <> &Отходы
	И НЕ БазоваяВыборкаЗнВП.СтатьяЗатрат В (&СтатьиЗатратСодержаниеОхранаТрудаПрочиеРемонтыТранспорт)
	И НЕ БазоваяВыборкаЗнВП.СтатьяЗатрат.Наименование ПОДОБНО "Потери от брака%"

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Отходы.Организация,
	Отходы.ПодразделениеОрганизации,
	&СтальВсего,
	Отходы.СтатьяЗатрат,
	Отходы.Номенклатура,
	Отходы.КоличествоЗатраты,
	Отходы.СуммаЗатраты,
	Отходы.Номенклатура.НоменклатурнаяГруппа,
	NULL,
	Отходы.Нормируемая,
	NULL,
	Отходы.Номенклатура.ЕдиницаХраненияОстатков,
	NULL,
	NULL
ИЗ
	Отходы КАК Отходы

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РПП_РемонтыСодержаниеОхранаТранспортПрочие.Организация,
	РПП_РемонтыСодержаниеОхранаТранспортПрочие.Подразделение,
	&СтальВсего,
	РПП_РемонтыСодержаниеОхранаТранспортПрочие.СтатьяЗатрат,
	РПП_РемонтыСодержаниеОхранаТранспортПрочие.Номенклатура,
	РПП_РемонтыСодержаниеОхранаТранспортПрочие.Количество,
	РПП_РемонтыСодержаниеОхранаТранспортПрочие.Стоимость,
	РПП_РемонтыСодержаниеОхранаТранспортПрочие.Подгруппа,
	РПП_РемонтыСодержаниеОхранаТранспортПрочие.Регистратор,
	РПП_РемонтыСодержаниеОхранаТранспортПрочие.Нормируемая,
	РПП_РемонтыСодержаниеОхранаТранспортПрочие.ПокупныеСобственные,
	РПП_РемонтыСодержаниеОхранаТранспортПрочие.ЕдиницаИзмерения,
	NULL,
	NULL
ИЗ
	ПравильныйОстатокРаспределения КАК РПП_РемонтыСодержаниеОхранаТранспортПрочие

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Брак.Организация,
	Брак.Подразделение,
	Брак.Продукция,
	Брак.СтатьяЗатрат,
	Брак.НоменклатурнаяГруппа,
	Брак.КоличествоБрака,
	Брак.СуммаБрака,
	Брак.НоменклатурнаяГруппаЗатрат,
	NULL,
	Брак.Нормируемая,
	Брак.ПокупныеСобственные,
	Брак.ЕдиницаИзмерения,
	NULL,
	NULL
ИЗ
	Брак КАК Брак

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ПотериОтБрака.Организация,
	ПотериОтБрака.Подразделение,
	ПотериОтБрака.Продукция,
	ПотериОтБрака.СтатьяЗатрат,
	ПотериОтБрака.Затрата,
	ПотериОтБрака.КоличествоОборот,
	ПотериОтБрака.СуммаОборот,
	ПотериОтБрака.НоменклатурнаяГруппаЗатрат,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL
ИЗ
	ПотериОтБрака КАК ПотериОтБрака

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЛомПотериОтБрака.Организация,
	ЛомПотериОтБрака.Подразделение,
	ЛомПотериОтБрака.Продукция,
	ЛомПотериОтБрака.СтатьяЗатрат,
	ЛомПотериОтБрака.Затрата,
	ЛомПотериОтБрака.КоличествоОборот,
	ЛомПотериОтБрака.СуммаОборот,
	ЛомПотериОтБрака.НоменклатурнаяГруппаЗатрат,
	NULL,
	ЛомПотериОтБрака.Нормируемая,
	NULL,
	ЛомПотериОтБрака.ЕдиницаХраненияОстатков,
	NULL,
	NULL
ИЗ
	ЛомПотериОтБрака КАК ЛомПотериОтБрака
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БазоваяВыборкаЗнВПОтходы.Организация,
	БазоваяВыборкаЗнВПОтходы.Подразделение,
	БазоваяВыборкаЗнВПОтходы.Продукция,
	БазоваяВыборкаЗнВПОтходы.СтатьяЗатрат,
	БазоваяВыборкаЗнВПОтходы.Затрата,
	БазоваяВыборкаЗнВПОтходы.КоличествоОборот,
	БазоваяВыборкаЗнВПОтходы.СуммаОборот,
	БазоваяВыборкаЗнВПОтходы.НоменклатурнаяГруппаЗатрат,
	ВЫБОР
		КОГДА БазоваяВыборкаЗнВПОтходы.Затрата.Наименование ПОДОБНО "Брак%"
			ТОГДА "Сырье и основные материалы"
		КОГДА БазоваяВыборкаЗнВПОтходы.Затрата.Наименование ПОДОБНО "Коксовая мелочь%"
			ТОГДА "Расходы по переделу"
		КОГДА БазоваяВыборкаЗнВПОтходы.СтатьяЗатрат.Наименование ПОДОБНО "%Сырье и основные материалы%"
			ТОГДА "Сырье и основные материалы"
		КОГДА БазоваяВыборкаЗнВПОтходы.СтатьяЗатрат.Наименование ПОДОБНО "%Топливо технологическое%"
			ТОГДА "Расходы по переделу"
		КОГДА БазоваяВыборкаЗнВПОтходы.СтатьяЗатрат.Наименование ПОДОБНО "%Отходы%"
			ТОГДА "Сырье и основные материалы"
		КОГДА БазоваяВыборкаЗнВПОтходы.Затрата ПОДОБНО "Выявленного в др.цехах и складах (+)"
			ТОГДА "Потери от брака"
		КОГДА БазоваяВыборкаЗнВПОтходы.Затрата ПОДОБНО "Относимого на другие цехи (-)"
			ТОГДА "Потери от брака"
		КОГДА БазоваяВыборкаЗнВПОтходы.СтатьяЗатрат.Наименование ПОДОБНО "Полуфабрикаты%"
			ТОГДА "Сырье и основные материалы"
		ИНАЧЕ ВЫБОР
				КОГДА БазоваяВыборкаЗнВПОтходы.Затрата.Наименование ПОДОБНО "%Газ природный%"
					ТОГДА "Расходы по переделу"
				КОГДА БазоваяВыборкаЗнВПОтходы.Затрата.Наименование ПОДОБНО "%Транспортировка природного газа%"
					ТОГДА "Расходы по переделу"
				КОГДА БазоваяВыборкаЗнВПОтходы.СтатьяЗатрат.Наименование ПОДОБНО "%911000%"
					ТОГДА "ОЗР"
				КОГДА БазоваяВыборкаЗнВПОтходы.СтатьяЗатрат В (&СтатьиЗатратОЗР)
					ТОГДА "ОЗР"
				ИНАЧЕ "Расходы по переделу"
			КОНЕЦ
	КОНЕЦ КАК Раздел,
	БазоваяВыборкаЗнВПОтходы.Регистратор,
	БазоваяВыборкаЗнВПОтходы.Нормируемая,
	БазоваяВыборкаЗнВПОтходы.ПокупныеСобственные,
	БазоваяВыборкаЗнВПОтходы.ЕдиницаИзмерения
ПОМЕСТИТЬ БазоваяВыборкаЗнВПОтходыРазделы
ИЗ
	БазоваяВыборкаЗнВПОтходы КАК БазоваяВыборкаЗнВПОтходы
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БазоваяВыборкаЗнВПОтходыРазделы.Организация,
	БазоваяВыборкаЗнВПОтходыРазделы.Подразделение,
	БазоваяВыборкаЗнВПОтходыРазделы.Продукция,
	БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат,
	БазоваяВыборкаЗнВПОтходыРазделы.Затрата КАК Затрата,
	БазоваяВыборкаЗнВПОтходыРазделы.КоличествоОборот КАК КоличествоОборот,
	БазоваяВыборкаЗнВПОтходыРазделы.СуммаОборот КАК СуммаОборот,
	БазоваяВыборкаЗнВПОтходыРазделы.НоменклатурнаяГруппаЗатрат,
	БазоваяВыборкаЗнВПОтходыРазделы.Раздел,
	ВЫБОР
		КОГДА БазоваяВыборкаЗнВПОтходыРазделы.Раздел ПОДОБНО "%Сырье и основные материалы%"
			ТОГДА ВЫБОР
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.Затрата.Наименование ПОДОБНО "Брак%"
						ТОГДА "Брак"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат.Наименование ПОДОБНО "%Отходы%"
						ТОГДА "Отходы и потери"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.Затрата.ВидНоменклатуры.Наименование ПОДОБНО "Полуфабрикат%"
						ТОГДА "Полуфабрикаты"
					ИНАЧЕ ВЫБОР
							КОГДА БазоваяВыборкаЗнВПОтходыРазделы.Подразделение.БВ_ВыпускПоСпецификации = ИСТИНА
								ТОГДА "Добавочные материалы"
						КОНЕЦ
				КОНЕЦ
		КОГДА БазоваяВыборкаЗнВПОтходыРазделы.Раздел = "Расходы по переделу"
			ТОГДА ВЫБОР
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.Затрата.Наименование ПОДОБНО "%Газ природный%"
						ТОГДА "Топливо"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.Затрата.Наименование ПОДОБНО "%Транспортировка природного газа%"
						ТОГДА "Топливо"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат.Наименование ПОДОБНО "%Энергетические затраты%"
						ТОГДА "Энергозатраты"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат.Наименование ПОДОБНО "%231000%"
						ТОГДА "Заработная плата с начислениями"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат.ВидЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыЗатрат.Амортизация)
						ТОГДА "Амортизация"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.Затрата.Наименование ПОДОБНО "Коксовая мелочь%"
						ТОГДА "Материалы на технологию"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат.Наименование ПОДОБНО "Сменное оборудование%"
						ТОГДА "Сменное оборудование"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат.Наименование ПОДОБНО "Ремонт валков%"
						ТОГДА "Сменное оборудование"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат.Наименование ПОДОБНО "913100%"
						ТОГДА "Капитальный ремонт"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат.Наименование ПОДОБНО "912100%"
						ТОГДА "Текущий ремонт"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат.Наименование ПОДОБНО "Ремонт зданий и сооружений%"
						ТОГДА "Ремонт зданий и сооружений"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат.Наименование ПОДОБНО "%910100, 910200 Содержание%"
						ТОГДА "Содержание оборудования"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат.Наименование ПОДОБНО "910100, 910200 Техническое обслуживание%"
						ТОГДА "Содержание оборудования"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат.Наименование ПОДОБНО "910100, 910200 Прочие расходы%"
						ТОГДА "Прочие цеховые расходы"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат.Наименование ПОДОБНО "910100, 910200 Охрана труда%"
						ТОГДА "Охрана труда"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат.Наименование ПОДОБНО "910100, 910200 Работа транспортных цехов%"
						ТОГДА "Транспортные расходы"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделы.СтатьяЗатрат.Наименование ПОДОБНО "Услуги Участок по отправке огнеупоров%"
						ТОГДА "Транспортные расходы"
					ИНАЧЕ "Прочие цеховые расходы"
				КОНЕЦ
	КОНЕЦ КАК Группа,
	БазоваяВыборкаЗнВПОтходыРазделы.Регистратор,
	БазоваяВыборкаЗнВПОтходыРазделы.Нормируемая,
	БазоваяВыборкаЗнВПОтходыРазделы.ПокупныеСобственные,
	БазоваяВыборкаЗнВПОтходыРазделы.ЕдиницаИзмерения
ПОМЕСТИТЬ БазоваяВыборкаЗнВПОтходыРазделыГруппы
ИЗ
	БазоваяВыборкаЗнВПОтходыРазделы КАК БазоваяВыборкаЗнВПОтходыРазделы
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	НЗПНаНачало.Организация,
	НЗПНаНачало.Подразделение,
	НЗПНаНачало.Продукция,
	НЗПНаНачало.СуммаОборот,
	НЗПНаНачало.КоличествоОборот,
	НЗПНаНачало.Раздел
ПОМЕСТИТЬ НЗПНаНачало
ИЗ
	(ВЫБРАТЬ
		НЗПНаКонец.Организация КАК Организация,
		НЗПНаКонец.Подразделение КАК Подразделение,
		&СтальВсего КАК Продукция,
		СУММА(НЗПНаКонец.СуммаОборот) КАК СуммаОборот,
		СУММА(НЗПНаКонец.КоличествоОборот) КАК КоличествоОборот,
		НЗПНаКонец.Раздел КАК Раздел
	ИЗ
		(ВЫБРАТЬ
			ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Организация КАК Организация,
			ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Подразделение КАК Подразделение,
			ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Продукция КАК Продукция,
			ЕСТЬNULL(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.СуммаОстаток, 0) КАК СуммаОборот,
			0 КАК КоличествоОборот,
			"НЗП на начало" КАК Раздел
		ИЗ
			РегистрНакопления.ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчет.Остатки(
					&НачДата,
					Организация = &Организация
						И Подразделение В ИЕРАРХИИ (&Подразделение)
						И Продукция В
							(ВЫБРАТЬ
								СпособыРаспределения.Продукция
							ИЗ
								СпособыРаспределения КАК СпособыРаспределения)) КАК ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Организация,
			ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Подразделение,
			ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Продукция,
			ЕСТЬNULL(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.СуммаРасход, 0),
			0,
			"НЗП на начало"
		ИЗ
			РегистрНакопления.ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчет.Обороты(
					НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(&НачДата, МЕСЯЦ, -1), МЕСЯЦ),
					КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(&КонДата, МЕСЯЦ, -1), МЕСЯЦ),
					,
					Организация = &Организация
						И Подразделение В ИЕРАРХИИ (&Подразделение)
						И Продукция В
							(ВЫБРАТЬ
								СпособыРаспределения.Продукция
							ИЗ
								СпособыРаспределения КАК СпособыРаспределения)) КАК ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			ВыпускНаработка.Организация,
			ВыпускНаработка.Подразделение,
			ВыпускНаработка.Продукция,
			0,
			ЕСТЬNULL(ВыпускНаработка.ОстатокНаНачало, 0),
			"НЗП на начало"
		ИЗ
			ВыпускПродукцииНаработка КАК ВыпускНаработка
		ГДЕ
			ВыпускНаработка.Продукция В
					(ВЫБРАТЬ
						СпособыРаспределения.Продукция
					ИЗ
						СпособыРаспределения КАК СпособыРаспределения)) КАК НЗПНаКонец
	
	СГРУППИРОВАТЬ ПО
		НЗПНаКонец.Организация,
		НЗПНаКонец.Подразделение,
		НЗПНаКонец.Раздел) КАК НЗПНаНачало
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	НЗПНаКонец.Организация,
	НЗПНаКонец.Подразделение,
	НЗПНаКонец.Продукция,
	НЗПНаКонец.СуммаОборот,
	НЗПНаКонец.КоличествоОборот,
	НЗПНаКонец.Раздел
ПОМЕСТИТЬ НЗПНаКонец
ИЗ
	(ВЫБРАТЬ
		НЗПНаКонец.Организация КАК Организация,
		НЗПНаКонец.Подразделение КАК Подразделение,
		&СтальВсего КАК Продукция,
		СУММА(НЗПНаКонец.СуммаОборот) КАК СуммаОборот,
		СУММА(НЗПНаКонец.КоличествоОборот) КАК КоличествоОборот,
		НЗПНаКонец.Раздел КАК Раздел
	ИЗ
		(ВЫБРАТЬ
			ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Организация КАК Организация,
			ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Подразделение КАК Подразделение,
			ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.Продукция КАК Продукция,
			ЕСТЬNULL(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки.СуммаОстаток, 0) КАК СуммаОборот,
			0 КАК КоличествоОборот,
			"НЗП на конец" КАК Раздел
		ИЗ
			РегистрНакопления.ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчет.Остатки(
					ДОБАВИТЬКДАТЕ(&КонДата, СЕКУНДА, 1),
					Организация = &Организация
						И Подразделение В ИЕРАРХИИ (&Подразделение)
						И Продукция В
							(ВЫБРАТЬ
								СпособыРаспределения.Продукция
							ИЗ
								СпособыРаспределения КАК СпособыРаспределения)) КАК ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОстатки
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Организация,
			ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Подразделение,
			ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.Продукция,
			ЕСТЬNULL(ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты.СуммаРасход, 0),
			0,
			"НЗП на конец"
		ИЗ
			РегистрНакопления.ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчет.Обороты(
					&НачДата,
					&КонДата,
					,
					Организация = &Организация
						И Подразделение В ИЕРАРХИИ (&Подразделение)
						И Продукция В
							(ВЫБРАТЬ
								СпособыРаспределения.Продукция
							ИЗ
								СпособыРаспределения КАК СпособыРаспределения)) КАК ЗатратыНаВыпускПродукцииНаработкаБухгалтерскийУчетОбороты
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			ВыпускНаработка.Организация,
			ВыпускНаработка.Подразделение,
			ВыпускНаработка.Продукция,
			0,
			ЕСТЬNULL(ВыпускНаработка.ОстатокНаКонец, 0),
			"НЗП на конец"
		ИЗ
			ВыпускПродукцииНаработка КАК ВыпускНаработка
		ГДЕ
			ВыпускНаработка.Продукция В
					(ВЫБРАТЬ
						СпособыРаспределения.Продукция
					ИЗ
						СпособыРаспределения КАК СпособыРаспределения)) КАК НЗПНаКонец
	
	СГРУППИРОВАТЬ ПО
		НЗПНаКонец.Организация,
		НЗПНаКонец.Подразделение,
		НЗПНаКонец.Раздел) КАК НЗПНаКонец
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВыпускПродукции.Организация,
	ВыпускПродукции.Подразделение,
	ВыпускПродукции.Продукция КАК Продукция,
	СУММА(ВыпускПродукции.КоличествоОборот) КАК КоличествоОборот
ПОМЕСТИТЬ ИтогоВыпускСНЗП
ИЗ
	ВыпускПродукции КАК ВыпускПродукции

СГРУППИРОВАТЬ ПО
	ВыпускПродукции.Организация,
	ВыпускПродукции.Продукция,
	ВыпускПродукции.Подразделение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВыпускСУчетомНЗП.Организация,
	ВыпускСУчетомНЗП.Подразделение,
	ВыпускСУчетомНЗП.Продукция,
	ВыпускСУчетомНЗП.КоличествоВыпуск,
	ВыпускСУчетомНЗП.КоличествоНЗПНаНачало,
	ВыпускСУчетомНЗП.КоличествоНЗПНаКонец,
	ВыпускСУчетомНЗП.КоличествоВыпуск + ВыпускСУчетомНЗП.КоличествоНЗПНаКонец - ВыпускСУчетомНЗП.КоличествоНЗПНаНачало КАК КоличествоОборот
ПОМЕСТИТЬ ИтогоВыпускКоличество
ИЗ
	(ВЫБРАТЬ
		ВыпускСУчетомНЗП.Организация КАК Организация,
		ВыпускСУчетомНЗП.Подразделение КАК Подразделение,
		&СтальВсего КАК Продукция,
		СУММА(ВыпускСУчетомНЗП.КоличествоВыпуск) КАК КоличествоВыпуск,
		СУММА(ВыпускСУчетомНЗП.КоличествоНЗПНаНачало) КАК КоличествоНЗПНаНачало,
		СУММА(ВыпускСУчетомНЗП.КоличествоНЗПНаКонец) КАК КоличествоНЗПНаКонец
	ИЗ
		(ВЫБРАТЬ
			ИтогоВыпуск.Организация КАК Организация,
			ИтогоВыпуск.Подразделение КАК Подразделение,
			ИтогоВыпуск.Продукция КАК Продукция,
			ИтогоВыпуск.КоличествоОборот КАК КоличествоВыпуск,
			0 КАК КоличествоНЗПНаНачало,
			0 КАК КоличествоНЗПНаКонец
		ИЗ
			ИтогоВыпускСНЗП КАК ИтогоВыпуск
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			НЗПНаНачало.Организация,
			НЗПНаНачало.Подразделение,
			НЗПНаНачало.Продукция,
			0,
			НЗПНаНачало.КоличествоОборот,
			0
		ИЗ
			НЗПНаНачало КАК НЗПНаНачало
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			НЗПНаКонец.Организация,
			НЗПНаКонец.Подразделение,
			НЗПНаКонец.Продукция,
			0,
			0,
			НЗПНаКонец.КоличествоОборот
		ИЗ
			НЗПНаКонец КАК НЗПНаКонец) КАК ВыпускСУчетомНЗП
	
	СГРУППИРОВАТЬ ПО
		ВыпускСУчетомНЗП.Организация,
		ВыпускСУчетомНЗП.Подразделение,
		ВыпускСУчетомНЗП.Продукция) КАК ВыпускСУчетомНЗП
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СУММА(БазоваяВыборкаЗнВПОтходыРазделыГруппы.КоличествоОборот) КАК КоличествоЗатрат,
	СУММА(БазоваяВыборкаЗнВПОтходыРазделыГруппы.СуммаОборот) КАК СтоимостьЗатрат,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Организация,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Подразделение,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Продукция
ПОМЕСТИТЬ Металлошихта
ИЗ
	БазоваяВыборкаЗнВПОтходыРазделыГруппы КАК БазоваяВыборкаЗнВПОтходыРазделыГруппы
ГДЕ
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа ПОДОБНО "%Полуфабрикаты%"

СГРУППИРОВАТЬ ПО
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Организация,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Подразделение,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Продукция
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Металлошихта.КоличествоЗатрат,
	Металлошихта.Организация,
	Металлошихта.Подразделение,
	Металлошихта.Продукция,
	ВыпускПродукции.КоличествоОборот КАК КоличествоВыпуск
ПОМЕСТИТЬ МеталлошихтаВыпуск
ИЗ
	Металлошихта КАК Металлошихта
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ИтогоВыпускКоличество КАК ВыпускПродукции
		ПО Металлошихта.Организация = ВыпускПродукции.Организация
			И Металлошихта.Подразделение = ВыпускПродукции.Подразделение
			И Металлошихта.Продукция = ВыпускПродукции.Продукция
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Отходы.Организация,
	Отходы.ПодразделениеОрганизации,
	&СтальВсего КАК Продукция,
	СУММА(Отходы.КоличествоЗатраты) КАК КоличествоЗатраты,
	СУММА(Отходы.СуммаЗатраты) КАК СуммаЗатраты
ПОМЕСТИТЬ ОтходыКоличествоВсего
ИЗ
	Отходы КАК Отходы

СГРУППИРОВАТЬ ПО
	Отходы.Организация,
	Отходы.ПодразделениеОрганизации
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	МеталлошихтаВыпуск.КоличествоЗатрат,
	МеталлошихтаВыпуск.Организация,
	МеталлошихтаВыпуск.Подразделение,
	МеталлошихтаВыпуск.Продукция,
	МеталлошихтаВыпуск.КоличествоВыпуск,
	ОтходыКоличествоВсего.КоличествоЗатраты,
	ОтходыКоличествоВсего.СуммаЗатраты,
	МеталлошихтаВыпуск.КоличествоЗатрат - МеталлошихтаВыпуск.КоличествоВыпуск + ОтходыКоличествоВсего.КоличествоЗатраты + БракИтого.КоличествоБрака КАК КоличествоУгар,
	"Угар" КАК Затрата,
	&Отходы КАК СтатьяЗатрат,
	"Сырье и основные материалы" КАК Раздел,
	"Отходы и потери" КАК Группа,
	"" КАК ПодГруппа,
	1 КАК ПорядокРазделов,
	4 КАК ПорядогГрупп,
	6 КАК ПорядокПодгрупп
ПОМЕСТИТЬ Угар
ИЗ
	МеталлошихтаВыпуск КАК МеталлошихтаВыпуск
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОтходыКоличествоВсего КАК ОтходыКоличествоВсего
		ПО МеталлошихтаВыпуск.Организация = ОтходыКоличествоВсего.Организация
			И МеталлошихтаВыпуск.Подразделение = ОтходыКоличествоВсего.ПодразделениеОрганизации
			И МеталлошихтаВыпуск.Продукция = ОтходыКоличествоВсего.Продукция
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ БракИтого КАК БракИтого
		ПО МеталлошихтаВыпуск.Организация = БракИтого.Организация
			И МеталлошихтаВыпуск.Подразделение = БракИтого.Подразделение
			И МеталлошихтаВыпуск.Продукция = БракИтого.Продукция
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Организация,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Подразделение,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Продукция,
	СУММА(БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.КоличествоОборот) КАК КоличествоОборот,
	СУММА(БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.СуммаОборот) КАК СуммаОборот
ПОМЕСТИТЬ ИтогоЗатраты
ИЗ
	БазоваяВыборкаЗнВПОтходыРазделыГруппы КАК БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы

СГРУППИРОВАТЬ ПО
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Организация,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Подразделение,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Продукция
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СУММА(БазоваяВыборкаЗнВПОтходыРазделыГруппы.КоличествоОборот) КАК КоличествоЗатрат,
	СУММА(БазоваяВыборкаЗнВПОтходыРазделыГруппы.СуммаОборот) КАК СтоимостьЗатрат,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Организация,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Подразделение,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Продукция
ПОМЕСТИТЬ СырьеИМатериалы
ИЗ
	БазоваяВыборкаЗнВПОтходыРазделыГруппы КАК БазоваяВыборкаЗнВПОтходыРазделыГруппы
ГДЕ
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Раздел ПОДОБНО "%Сырье и основные материалы%"

СГРУППИРОВАТЬ ПО
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Организация,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Подразделение,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Продукция
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СУММА(БазоваяВыборкаЗнВПОтходыРазделыГруппы.КоличествоОборот) КАК КоличествоЗатрат,
	СУММА(БазоваяВыборкаЗнВПОтходыРазделыГруппы.СуммаОборот) КАК СтоимостьЗатрат,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Организация,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Подразделение,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Продукция
ПОМЕСТИТЬ ДобавочныеМатериалы
ИЗ
	БазоваяВыборкаЗнВПОтходыРазделыГруппы КАК БазоваяВыборкаЗнВПОтходыРазделыГруппы
ГДЕ
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа ПОДОБНО "Добавочные материалы%"

СГРУППИРОВАТЬ ПО
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Организация,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Подразделение,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Продукция
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СырьеИМатериалы.Организация,
	СырьеИМатериалы.Подразделение,
	СырьеИМатериалы.Продукция,
	1 КАК КоличествоНаЕдиницу,
	"" КАК Затрата,
	NULL КАК СтатьяЗатрат,
	"Задано за вычетом брака и отходов" КАК Раздел,
	"" КАК Группа,
	"" КАК ПодГруппа,
	2 КАК ПорядокРазделов,
	1 КАК ПорядогГрупп,
	1 КАК ПорядокПодгрупп,
	СырьеИМатериалы.СтоимостьЗатрат - ЕСТЬNULL(ДобавочныеМатериалы.СтоимостьЗатрат, 0) КАК СтоимостьМеталлошихтаМинусОтходы,
	ИтогоВыпуск.КоличествоОборот КАК КоличествоВыпуск
ПОМЕСТИТЬ Задано
ИЗ
	СырьеИМатериалы КАК СырьеИМатериалы
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ИтогоВыпускКоличество КАК ИтогоВыпуск
		ПО СырьеИМатериалы.Организация = ИтогоВыпуск.Организация
			И СырьеИМатериалы.Подразделение = ИтогоВыпуск.Подразделение
			И СырьеИМатериалы.Продукция = ИтогоВыпуск.Продукция
		ЛЕВОЕ СОЕДИНЕНИЕ ДобавочныеМатериалы КАК ДобавочныеМатериалы
		ПО СырьеИМатериалы.Организация = ДобавочныеМатериалы.Организация
			И СырьеИМатериалы.Подразделение = ДобавочныеМатериалы.Подразделение
			И СырьеИМатериалы.Продукция = ДобавочныеМатериалы.Продукция
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СырьеИМатериалы.Организация,
	СырьеИМатериалы.Подразделение,
	СырьеИМатериалы.Продукция,
	СырьеИМатериалы.СтоимостьЗатрат / ИтогоВыпуск.КоличествоОборот КАК СтоимостьНаЕдиницу,
	ИтогоВыпуск.КоличествоОборот КАК КоличествоОборот,
	NULL КАК КоличествоНаЕдиницу,
	"" КАК Затрата,
	NULL КАК СтатьяЗатрат,
	"Всего с добавочными материалами" КАК Раздел,
	"" КАК Группа,
	"" КАК ПодГруппа,
	3 КАК ПорядокРазделов,
	1 КАК ПорядогГрупп,
	1 КАК ПорядокПодгрупп,
	СырьеИМатериалы.СтоимостьЗатрат КАК СтоимостьМеталлошихтаМинусОтходы
ПОМЕСТИТЬ ЗаданоВсегоСДобавочными
ИЗ
	СырьеИМатериалы КАК СырьеИМатериалы
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ИтогоВыпускКоличество КАК ИтогоВыпуск
		ПО СырьеИМатериалы.Организация = ИтогоВыпуск.Организация
			И СырьеИМатериалы.Подразделение = ИтогоВыпуск.Подразделение
			И СырьеИМатериалы.Продукция = ИтогоВыпуск.Продукция
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	РППИтого.Организация,
	РППИтого.Подразделение,
	РППИтого.Продукция,
	РППИтого.СуммаОборот,
	РППИтого.СуммаОборот / ИтогоВыпуск.КоличествоОборот КАК СтоимостьНаЕдиницу,
	NULL КАК КоличествоОборот,
	NULL КАК КоличествоНаЕдиницу,
	"" КАК Затрата,
	NULL КАК СтатьяЗатрат,
	"Расходы по переделу ИТОГО" КАК Раздел,
	"" КАК Группа,
	"" КАК ПодГруппа,
	4 КАК ПорядокРазделов,
	1 КАК ПорядогГрупп,
	1 КАК ПорядокПодгрупп
ПОМЕСТИТЬ РППИтого
ИЗ
	(ВЫБРАТЬ
		БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Организация КАК Организация,
		БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Подразделение КАК Подразделение,
		БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Продукция КАК Продукция,
		СУММА(БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.СуммаОборот) КАК СуммаОборот
	ИЗ
		БазоваяВыборкаЗнВПОтходыРазделыГруппы КАК БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы
	ГДЕ
		БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Раздел = "Расходы по переделу"
	
	СГРУППИРОВАТЬ ПО
		БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Организация,
		БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Подразделение,
		БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Продукция) КАК РППИтого
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ИтогоВыпускКоличество КАК ИтогоВыпуск
		ПО РППИтого.Организация = ИтогоВыпуск.Организация
			И РППИтого.Подразделение = ИтогоВыпуск.Подразделение
			И РППИтого.Продукция = ИтогоВыпуск.Продукция
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПРоизводственнаяСебестоимость.Организация,
	ПРоизводственнаяСебестоимость.Подразделение,
	ПРоизводственнаяСебестоимость.Продукция,
	СУММА(ПРоизводственнаяСебестоимость.СуммаОборот) КАК СтоимостьОборот,
	Сумма(ПРоизводственнаяСебестоимость.КоличествоВыпуск) КАК КоличествоОборот
ПОМЕСТИТЬ ПроизводственнаяСебестоимостьСумма
ИЗ
	(ВЫБРАТЬ
		Задано.Организация КАК Организация,
		Задано.Подразделение КАК Подразделение,
		Задано.Продукция КАК Продукция,
		Задано.СтоимостьМеталлошихтаМинусОтходы КАК СуммаОборот,
		Задано.КоличествоВыпуск КАК КоличествоВыпуск
	ИЗ
		Задано КАК Задано
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		РППИтого.Организация,
		РППИтого.Подразделение,
		&СтальВсего,
		РППИтого.СуммаОборот,
		0
	ИЗ
		РППИтого КАК РППИтого
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ПотериОтБрака.Организация,
		ПотериОтБрака.Подразделение,
		&СтальВсего,
		ПотериОтБрака.СуммаОборот,
		0
	ИЗ
		ПотериОтБрака КАК ПотериОтБрака
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		БазоваяВыборкаЗнВПОтходыРазделы.Организация,
		БазоваяВыборкаЗнВПОтходыРазделы.Подразделение,
		БазоваяВыборкаЗнВПОтходыРазделы.Продукция,
		БазоваяВыборкаЗнВПОтходыРазделы.СуммаОборот,
		0
	ИЗ
		БазоваяВыборкаЗнВПОтходыРазделы КАК БазоваяВыборкаЗнВПОтходыРазделы
	ГДЕ
		БазоваяВыборкаЗнВПОтходыРазделы.Раздел = "ОЗР") КАК ПРоизводственнаяСебестоимость

СГРУППИРОВАТЬ ПО
	ПРоизводственнаяСебестоимость.Организация,
	ПРоизводственнаяСебестоимость.Подразделение,
	ПРоизводственнаяСебестоимость.Продукция
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВыпускПродукции.Организация,
	ВыпускПродукции.Подразделение,
	ВыпускПродукции.Продукция,
	ВыпускПродукции.СтоимостьОборот,
	Выбор Когда ВыпускПродукции.КоличествоОборот = 0 Тогда
		0
	Иначе
		ВыпускПродукции.СтоимостьОборот / ВыпускПродукции.КоличествоОборот
	Конец  КАК СтоимостьЗаЕдиницу,
	ВыпускПродукции.КоличествоОборот КАК КоличествоОборот,
	NULL КАК КоличествоНаЕдиницу,
	"" КАК Затрата,
	NULL КАК СтатьяЗатрат,
	"Производственная себестоимость" КАК Раздел,
	"" КАК Группа,
	"" КАК ПодГруппа,
	7 КАК ПорядокРазделов,
	1 КАК ПорядогГрупп,
	1 КАК ПорядокПодгрупп
ПОМЕСТИТЬ ПроизводственнаяСебестоимость
ИЗ
	ПроизводственнаяСебестоимостьСумма КАК ВыпускПродукции
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВыпускСУчетомНЗП.Организация,
	ВыпускСУчетомНЗП.Подразделение,
	ВыпускСУчетомНЗП.Продукция,
	ВыпускСУчетомНЗП.СтоимостьВыпуск КАК СтоимостьБезНЗП,
	ВыпускСУчетомНЗП.СтоимостьНЗПНаНачало,
	ВыпускСУчетомНЗП.СтоимостьНЗПНаКонец,
	ВыпускСУчетомНЗП.СтоимостьВыпуск - ВыпускСУчетомНЗП.СтоимостьНЗПНаКонец + ВыпускСУчетомНЗП.СтоимостьНЗПНаНачало КАК СтоимостьСНЗП
ПОМЕСТИТЬ ИтогоВыпускСумма
ИЗ
	(ВЫБРАТЬ
		ВыпускСУчетомНЗП.Организация КАК Организация,
		ВыпускСУчетомНЗП.Подразделение КАК Подразделение,
		&СтальВсего КАК Продукция,
		СУММА(ВыпускСУчетомНЗП.СтоимостьВыпуск) КАК СтоимостьВыпуск,
		СУММА(ВыпускСУчетомНЗП.СтоимостьНЗПНаНачало) КАК СтоимостьНЗПНаНачало,
		СУММА(ВыпускСУчетомНЗП.СтоимостьНЗПНаКонец) КАК СтоимостьНЗПНаКонец
	ИЗ
		(ВЫБРАТЬ
			ПроизводственнаяСебестоимостьСумма.Организация КАК Организация,
			ПроизводственнаяСебестоимостьСумма.Подразделение КАК Подразделение,
			ПроизводственнаяСебестоимостьСумма.Продукция КАК Продукция,
			ПроизводственнаяСебестоимостьСумма.СтоимостьОборот КАК СтоимостьВыпуск,
			0 КАК СтоимостьНЗПНаНачало,
			0 КАК СтоимостьНЗПНаКонец
		ИЗ
			ПроизводственнаяСебестоимостьСумма КАК ПроизводственнаяСебестоимостьСумма
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			НЗПНаНачало.Организация,
			НЗПНаНачало.Подразделение,
			НЗПНаНачало.Продукция,
			0,
			НЗПНаНачало.СуммаОборот,
			0
		ИЗ
			НЗПНаНачало КАК НЗПНаНачало
		
		ОБЪЕДИНИТЬ ВСЕ
		
		ВЫБРАТЬ
			НЗПНаКонец.Организация,
			НЗПНаКонец.Подразделение,
			НЗПНаКонец.Продукция,
			0,
			0,
			НЗПНаКонец.СуммаОборот
		ИЗ
			НЗПНаКонец КАК НЗПНаКонец) КАК ВыпускСУчетомНЗП
	
	СГРУППИРОВАТЬ ПО
		ВыпускСУчетомНЗП.Организация,
		ВыпускСУчетомНЗП.Подразделение,
		ВыпускСУчетомНЗП.Продукция) КАК ВыпускСУчетомНЗП
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ИтогоВыпускКоличествоИСумма.Организация,
	ИтогоВыпускКоличествоИСумма.Подразделение,
	ИтогоВыпускКоличествоИСумма.Продукция,
	СУММА(ИтогоВыпускКоличествоИСумма.КоличествоВыпуск) КАК КоличествоВыпуск,
	СУММА(ИтогоВыпускКоличествоИСумма.КоличествоНЗПНаНачало) КАК КоличествоНЗПНаНачало,
	СУММА(ИтогоВыпускКоличествоИСумма.КоличествоНЗПНаКонец) КАК КоличествоНЗПНаКонец,
	СУММА(ИтогоВыпускКоличествоИСумма.КоличествоОборот) КАК КоличествоОборот,
	СУММА(ИтогоВыпускКоличествоИСумма.СтоимостьБезНЗП) КАК СтоимостьБезНЗП,
	СУММА(ИтогоВыпускКоличествоИСумма.СтоимостьНЗПНаНачало) КАК СтоимостьНЗПНаНачало,
	СУММА(ИтогоВыпускКоличествоИСумма.СтоимостьНЗПНаКонец) КАК СтоимостьНЗПНаКонец,
	СУММА(ИтогоВыпускКоличествоИСумма.СтоимостьСНЗП) КАК СтоимостьСНЗП
ПОМЕСТИТЬ ИтогоВыпуск
ИЗ
	(ВЫБРАТЬ
		ИтогоВыпускКоличество.Организация КАК Организация,
		ИтогоВыпускКоличество.Подразделение КАК Подразделение,
		ИтогоВыпускКоличество.Продукция КАК Продукция,
		ИтогоВыпускКоличество.КоличествоВыпуск КАК КоличествоВыпуск,
		ИтогоВыпускКоличество.КоличествоНЗПНаНачало КАК КоличествоНЗПНаНачало,
		ИтогоВыпускКоличество.КоличествоНЗПНаКонец КАК КоличествоНЗПНаКонец,
		ИтогоВыпускКоличество.КоличествоОборот КАК КоличествоОборот,
		0 КАК СтоимостьБезНЗП,
		0 КАК СтоимостьНЗПНаНачало,
		0 КАК СтоимостьНЗПНаКонец,
		0 КАК СтоимостьСНЗП
	ИЗ
		ИтогоВыпускКоличество КАК ИтогоВыпускКоличество
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ИтогоВыпускСумма.Организация,
		ИтогоВыпускСумма.Подразделение,
		ИтогоВыпускСумма.Продукция,
		0,
		0,
		0,
		0,
		ИтогоВыпускСумма.СтоимостьБезНЗП,
		ИтогоВыпускСумма.СтоимостьНЗПНаНачало,
		ИтогоВыпускСумма.СтоимостьНЗПНаКонец,
		ИтогоВыпускСумма.СтоимостьСНЗП
	ИЗ
		ИтогоВыпускСумма КАК ИтогоВыпускСумма) КАК ИтогоВыпускКоличествоИСумма

СГРУППИРОВАТЬ ПО
	ИтогоВыпускКоличествоИСумма.Организация,
	ИтогоВыпускКоличествоИСумма.Подразделение,
	ИтогоВыпускКоличествоИСумма.Продукция
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Организация,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Подразделение,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Продукция,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат,
	ВЫБОР
		КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.ВидЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыЗатрат.ОтчисленияНаСоциальныеНужды)
			ТОГДА "начисления на з/плату"
		КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.ВидЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыЗатрат.ОплатаТруда)
			ТОГДА ВЫБОР
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.Наименование ПОДОБНО "%резерв%"
						ТОГДА "резервы отпусков с начислениями"
					ИНАЧЕ "заработная плата"
				КОНЕЦ
		ИНАЧЕ ВЫБОР
				КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа = "Прочие цеховые расходы"
					ТОГДА ВЫБОР
							КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат ЕСТЬ NULL
								ТОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.Наименование
							ИНАЧЕ БазоваяВыборкаЗнВПОтходыРазделыГруппы.Затрата
						КОНЕЦ
				ИНАЧЕ БазоваяВыборкаЗнВПОтходыРазделыГруппы.Затрата
			КОНЕЦ
	КОНЕЦ КАК Затрата,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.КоличествоОборот КАК КоличествоОборот,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.СуммаОборот,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Раздел,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа,
	ВЫБОР
		КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Раздел ПОДОБНО "%Сырье и основные материалы%"
			ТОГДА ВЫБОР
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа ПОДОБНО "Металлошихта%"
						ТОГДА ВЫБОР
								КОГДА (БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат).Наименование ПОДОБНО "Ферросплавы%"
									ТОГДА "Раскислители"
								КОГДА (БазоваяВыборкаЗнВПОтходыРазделыГруппы.Затрата).Наименование ПОДОБНО "Лом алюминия%"
									ТОГДА "Раскислители"
								КОГДА (БазоваяВыборкаЗнВПОтходыРазделыГруппы.Затрата).ВидНоменклатуры.Наименование ПОДОБНО "Лом%"
									ТОГДА "Лом"
								КОГДА (БазоваяВыборкаЗнВПОтходыРазделыГруппы.Затрата).Наименование ПОДОБНО "чугун%"
									ТОГДА "Чугун"
							КОНЕЦ
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа ПОДОБНО "%Отходы%"
						ТОГДА ""
					ИНАЧЕ ""
				КОНЕЦ
		КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Раздел ПОДОБНО "%Расходы по переделу%"
			ТОГДА ВЫБОР
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат = "Усреднение партий"
						ТОГДА "Усреднение партий"
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа = "Содержание оборудования"
							ИЛИ БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа = "Прочие цеховые расходы"
							ИЛИ БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа = "Охрана труда"
						ТОГДА ВЫБОР
								КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.ВидЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыЗатрат.ОтчисленияНаСоциальныеНужды)
										ИЛИ БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.ВидЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыЗатрат.ОплатаТруда)
									ТОГДА "Зарплата с начислениями"
								ИНАЧЕ ВЫБОР
										КОГДА ВЫРАЗИТЬ(БазоваяВыборкаЗнВПОтходыРазделыГруппы.Затрата КАК Справочник.Номенклатура).Наименование ПОДОБНО "Транспортировка газа%"
											ТОГДА "Энергозатраты"
										КОГДА ВЫРАЗИТЬ(БазоваяВыборкаЗнВПОтходыРазделыГруппы.Затрата КАК Справочник.Номенклатура).ВидНоменклатуры.Наименование ПОДОБНО "Огнеупор%"
											ТОГДА "Огнеупоры"
										ИНАЧЕ ВЫБОР
												КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.Наименование ПОДОБНО "Потери от брака%"
													ТОГДА "Услуги цехов"
												КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СуммаОборот < 0
													ТОГДА "Возвраты"
												КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат ССЫЛКА Справочник.НоменклатурныеГруппы
													ТОГДА ВЫБОР
															КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат.Наименование ПОДОБНО "Запасные%"
																ТОГДА "Запчасти"
															КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат.Наименование ПОДОБНО "Топливо ГСМ%"
																ТОГДА "ГСМ"
															ИНАЧЕ "Вспомогательные материалы"
														КОНЕЦ
												ИНАЧЕ ВЫБОР
														КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат ЕСТЬ NULL
															ТОГДА ВЫБОР
																	КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.Наименование ПОДОБНО "910100, 910200 Услуги%"
																		ТОГДА "Услуги цехов"
																	ИНАЧЕ "Прочее"
																КОНЕЦ
														ИНАЧЕ БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат
													КОНЕЦ
											КОНЕЦ
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВЫБОР
							КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа ПОДОБНО "Топливо"
								ТОГДА ""
							КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.ВидЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыЗатрат.ОтчисленияНаСоциальныеНужды)
								ТОГДА "начисления на з/плату"
							КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.ВидЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыЗатрат.ОплатаТруда)
								ТОГДА ВЫБОР
										КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.Наименование ПОДОБНО "%резерв%"
											ТОГДА "резервы отпусков с начислениями"
										ИНАЧЕ "заработная плата"
									КОНЕЦ
							КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.Наименование ПОДОБНО "913100%"
								ТОГДА "Услуги цехов"
							КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.Наименование ПОДОБНО "912100%"
								ТОГДА "Услуги цехов"
							КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.Наименование ПОДОБНО "Ремонт зданий и сооружений%"
								ТОГДА "Услуги цехов"
						КОНЕЦ
				КОНЕЦ
	КОНЕЦ КАК ПодГруппа,
	ВЫБОР
		КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Раздел ПОДОБНО "%Сырье и основные материалы%"
			ТОГДА 1
		КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Раздел ПОДОБНО "%Производственная себестоимость%"
			ТОГДА 7
		КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Раздел ПОДОБНО "%Расходы по переделу%"
			ТОГДА 8
		КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Раздел = "ОЗР"
			ТОГДА 5
		КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Раздел = "Потери от брака"
			ТОГДА 6
		ИНАЧЕ 99
	КОНЕЦ КАК ПорядокРазделов,
	ВЫБОР
		КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Раздел ПОДОБНО "%Сырье и основные материалы%"
			ТОГДА ВЫБОР
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа ПОДОБНО "Брак%"
						ТОГДА 3
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа ПОДОБНО "%Отходы%"
						ТОГДА 4
					ИНАЧЕ 1
				КОНЕЦ
		КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Раздел ПОДОБНО "%Расходы по переделу%"
			ТОГДА ВЫБОР
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа ПОДОБНО "Топливо%"
						ТОГДА 1
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.Наименование ПОДОБНО "%Энергетические затраты%"
						ТОГДА 2
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.Наименование ПОДОБНО "%231000%"
						ТОГДА 3
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.ВидЗатрат = ЗНАЧЕНИЕ(Перечисление.ВидыЗатрат.Амортизация)
						ТОГДА 4
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа ПОДОБНО "Материалы на технологию%"
						ТОГДА 5
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа ПОДОБНО "Сменное оборудование"
						ТОГДА 6
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.Наименование ПОДОБНО "913100%"
						ТОГДА 7
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.Наименование ПОДОБНО "912100%"
						ТОГДА 8
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат.Наименование ПОДОБНО "Ремонт зданий и сооружений%"
						ТОГДА 9
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа ПОДОБНО "Содержание оборудования%"
						ТОГДА 10
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа ПОДОБНО "Охрана труда%"
						ТОГДА 11
					КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа ПОДОБНО "Транспортные расходы%"
						ТОГДА 12
					ИНАЧЕ 15
				КОНЕЦ
	КОНЕЦ КАК ПорядокГрупп,
	ВЫБОР
		КОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.Раздел ПОДОБНО "%Сырье и основные материалы%"
			ТОГДА ВЫБОР
					КОГДА (БазоваяВыборкаЗнВПОтходыРазделыГруппы.Затрата).Наименование ПОДОБНО "Лом алюминия%"
						ТОГДА 3
					КОГДА (БазоваяВыборкаЗнВПОтходыРазделыГруппы.Затрата).Наименование ПОДОБНО "Чугун%"
						ТОГДА 1
					КОГДА (БазоваяВыборкаЗнВПОтходыРазделыГруппы.Затрата).ВидНоменклатуры.Наименование ПОДОБНО "Лом%"
						ТОГДА 2
					ИНАЧЕ 5
				КОНЕЦ
	КОНЕЦ КАК ПорядокПодГрупп,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Регистратор,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Нормируемая,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.ПокупныеСобственные,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.ЕдиницаИзмерения КАК ЕдиницаИзмерения
ПОМЕСТИТЬ БазоваяВыборкаЗнВПРасшифровка
ИЗ
	БазоваяВыборкаЗнВПОтходыРазделыГруппы КАК БазоваяВыборкаЗнВПОтходыРазделыГруппы
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Организация,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Подразделение,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Продукция,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.СтатьяЗатрат,
	ВЫБОР
		КОГДА (БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа = "Содержание оборудования"
				ИЛИ БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа = "Охрана труда"
				ИЛИ БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа = "Прочие цеховые расходы")
				И БазоваяВыборкаЗнВПОтходыРазделыГруппы.Нормируемая = ЛОЖЬ
				И НЕ(БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат = "Подрядчики"
						ИЛИ БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат = "Прочее")
			ТОГДА БазоваяВыборкаЗнВПОтходыРазделыГруппы.ПокупныеСобственные
		ИНАЧЕ БазоваяВыборкаЗнВПОтходыРазделыГруппы.Затрата
	КОНЕЦ КАК Затрата,
	ВЫБОР
		КОГДА (БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа = "Содержание оборудования"
				ИЛИ БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа = "Охрана труда"
				ИЛИ БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа = "Прочие цеховые расходы")
				И БазоваяВыборкаЗнВПОтходыРазделыГруппы.Нормируемая = ЛОЖЬ
				И НЕ(БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат = "Подрядчики"
						ИЛИ БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат = "Прочее")
			ТОГДА 0
		ИНАЧЕ БазоваяВыборкаЗнВПОтходыРазделыГруппы.КоличествоОборот
	КОНЕЦ КАК КоличествоОборот,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.СуммаОборот,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Раздел,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.ПодГруппа КАК ПодГруппа,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.ПорядокРазделов КАК ПорядокРазделов,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.ПорядокГрупп КАК ПорядокГрупп,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.ПорядокПодГрупп КАК ПорядокПодГрупп,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Регистратор,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.Нормируемая,
	БазоваяВыборкаЗнВПОтходыРазделыГруппы.ПокупныеСобственные,
	ВЫБОР
		КОГДА (БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа = "Содержание оборудования"
				ИЛИ БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа = "Охрана труда"
				ИЛИ БазоваяВыборкаЗнВПОтходыРазделыГруппы.Группа = "Прочие цеховые расходы")
				И БазоваяВыборкаЗнВПОтходыРазделыГруппы.Нормируемая = ЛОЖЬ
				И НЕ(БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат = "Подрядчики"
						ИЛИ БазоваяВыборкаЗнВПОтходыРазделыГруппы.НоменклатурнаяГруппаЗатрат = "Прочее")
			ТОГДА ""
		ИНАЧЕ БазоваяВыборкаЗнВПОтходыРазделыГруппы.ЕдиницаИзмерения
	КОНЕЦ КАК ЕдиницаИзмерения,
	NULL КАК СтоимостьНаЕдиницу,
	NULL КАК КоличествоНаЕдиницу
ПОМЕСТИТЬ БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы
ИЗ
	БазоваяВыборкаЗнВПРасшифровка КАК БазоваяВыборкаЗнВПОтходыРазделыГруппы

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Угар.Организация,
	Угар.Подразделение,
	Угар.Продукция,
	Угар.СтатьяЗатрат,
	Угар.Затрата,
	-Угар.КоличествоУгар,
	0,
	NULL,
	Угар.Раздел,
	Угар.Группа,
	Угар.ПодГруппа,
	Угар.ПорядокРазделов,
	Угар.ПорядогГрупп,
	Угар.ПорядокПодгрупп,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL
ИЗ
	Угар КАК Угар

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Задано.Организация,
	Задано.Подразделение,
	Задано.Продукция,
	Задано.СтатьяЗатрат,
	Задано.Затрата,
	Задано.КоличествоВыпуск,
	Задано.СтоимостьМеталлошихтаМинусОтходы,
	NULL,
	Задано.Раздел,
	Задано.Группа,
	Задано.ПодГруппа,
	Задано.ПорядокРазделов,
	Задано.ПорядогГрупп,
	Задано.ПорядокПодгрупп,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL
ИЗ
	Задано КАК Задано

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РППИтого.Организация,
	РППИтого.Подразделение,
	РППИтого.Продукция,
	РППИтого.СтатьяЗатрат,
	РППИтого.Затрата,
	РППИтого.КоличествоОборот,
	РППИтого.СуммаОборот,
	NULL,
	РППИтого.Раздел,
	РППИтого.Группа,
	РППИтого.ПодГруппа,
	РППИтого.ПорядокРазделов,
	РППИтого.ПорядогГрупп,
	РППИтого.ПорядокПодгрупп,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL
ИЗ
	РППИтого КАК РППИтого

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ПроизводственнаяСебестоимость.Организация,
	ПроизводственнаяСебестоимость.Подразделение,
	ПроизводственнаяСебестоимость.Продукция,
	ПроизводственнаяСебестоимость.СтатьяЗатрат,
	ПроизводственнаяСебестоимость.Затрата,
	ПроизводственнаяСебестоимость.КоличествоОборот,
	ПроизводственнаяСебестоимость.СтоимостьОборот,
	NULL,
	ПроизводственнаяСебестоимость.Раздел,
	ПроизводственнаяСебестоимость.Группа,
	ПроизводственнаяСебестоимость.ПодГруппа,
	ПроизводственнаяСебестоимость.ПорядокРазделов,
	ПроизводственнаяСебестоимость.ПорядогГрупп,
	ПроизводственнаяСебестоимость.ПорядокПодгрупп,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL
ИЗ
	ПроизводственнаяСебестоимость КАК ПроизводственнаяСебестоимость

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗаданоВсегоСДобавочными.Организация,
	ЗаданоВсегоСДобавочными.Подразделение,
	ЗаданоВсегоСДобавочными.Продукция,
	ЗаданоВсегоСДобавочными.СтатьяЗатрат,
	ЗаданоВсегоСДобавочными.Затрата,
	ЗаданоВсегоСДобавочными.КоличествоОборот,
	ЗаданоВсегоСДобавочными.СтоимостьМеталлошихтаМинусОтходы,
	NULL,
	ЗаданоВсегоСДобавочными.Раздел,
	ЗаданоВсегоСДобавочными.Группа,
	ЗаданоВсегоСДобавочными.ПодГруппа,
	ЗаданоВсегоСДобавочными.ПорядокРазделов,
	ЗаданоВсегоСДобавочными.ПорядогГрупп,
	ЗаданоВсегоСДобавочными.ПорядокПодгрупп,
	NULL,
	NULL,
	NULL,
	NULL,
	ЗаданоВсегоСДобавочными.СтоимостьНаЕдиницу,
	ЗаданоВсегоСДобавочными.КоличествоНаЕдиницу
ИЗ
	ЗаданоВсегоСДобавочными КАК ЗаданоВсегоСДобавочными
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Организация,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Подразделение,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Продукция,
	МАКСИМУМ(БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.СтатьяЗатрат) КАК СтатьяЗатрат,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Затрата КАК Затрата,
	СУММА(БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.КоличествоОборот) КАК КоличествоОборот,
	СУММА(БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.СуммаОборот) КАК СуммаОборот,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Раздел,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Группа,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.ПодГруппа КАК Подгруппа,
	МАКСИМУМ(БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.ПорядокРазделов) КАК ПорядокРазделов,
	МАКСИМУМ(БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.ПорядокГрупп) КАК ПорядокГрупп,
	МАКСИМУМ(БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.ПорядокПодГрупп) КАК ПорядокПодГрупп
ПОМЕСТИТЬ РезультатБезПорядка
ИЗ
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы КАК БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы

СГРУППИРОВАТЬ ПО
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Организация,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Подразделение,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Продукция,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Раздел,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Группа,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.Затрата,
	БазоваяВыборкаЗнВПОтходыРазделыГруппыПодгруппы.ПодГруппа
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	РезультатБезПорядка.Организация,
	РезультатБезПорядка.Подразделение,
	РезультатБезПорядка.Продукция,
	РезультатБезПорядка.СтатьяЗатрат,
	РезультатБезПорядка.Затрата,
	РезультатБезПорядка.КоличествоОборот,
	РезультатБезПорядка.СуммаОборот,
	РезультатБезПорядка.Раздел,
	РезультатБезПорядка.Группа,
	РезультатБезПорядка.Подгруппа,
	РезультатБезПорядка.ПорядокРазделов,
	РезультатБезПорядка.ПорядокГрупп,
	ВЫБОР
		КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Усреднение партий"
			ТОГДА 13
		КОГДА РезультатБезПорядка.Группа = "Содержание оборудования"
			ТОГДА ВЫБОР
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Энергозатраты"
						ТОГДА 1
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Зарплата с начислениями"
						ТОГДА 2
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "огнеупор%"
						ТОГДА 3
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Запчасти%"
						ТОГДА 4
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "ГСМ%"
						ТОГДА 5
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Вспомогательные материалы%"
						ТОГДА 6
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Подрядчики"
						ТОГДА 8
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Услуги цехов"
						ТОГДА 9
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Прочее"
						ТОГДА 10
					ИНАЧЕ РезультатБезПорядка.ПорядокПодГрупп
				КОНЕЦ
		КОГДА РезультатБезПорядка.Группа ПОДОБНО "Охрана труда%"
			ТОГДА ВЫБОР
					КОГДА РезультатБезПорядка.Подгруппа ССЫЛКА Справочник.НоменклатурныеГруппы
						ТОГДА 2
					ИНАЧЕ ВЫБОР
							КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Энергозатраты"
								ТОГДА 1
							КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Подрядчики"
								ТОГДА 8
							КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Услуги цехов"
								ТОГДА 9
							КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Прочее"
								ТОГДА 10
							ИНАЧЕ РезультатБезПорядка.ПорядокПодГрупп
						КОНЕЦ
				КОНЕЦ
		КОГДА РезультатБезПорядка.Группа = "Прочие цеховые расходы"
			ТОГДА ВЫБОР
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Энергозатраты"
						ТОГДА 1
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Зарплата с начислениями"
						ТОГДА 2
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Вспомогательные материалы"
						ТОГДА 6
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Подрядчики"
						ТОГДА 8
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Услуги цехов"
						ТОГДА 9
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Возвраты"
						ТОГДА 10
					КОГДА РезультатБезПорядка.Подгруппа ПОДОБНО "Прочее"
						ТОГДА 11
					ИНАЧЕ РезультатБезПорядка.ПорядокПодГрупп
				КОНЕЦ
		ИНАЧЕ РезультатБезПорядка.ПорядокПодГрупп
	КОНЕЦ КАК ПорядокПодГрупп,
	ВЫБОР
		КОГДА РезультатБезПорядка.Затрата = "начисления на з/плату"
			ТОГДА 2
		КОГДА РезультатБезПорядка.Затрата = "заработная плата"
			ТОГДА 1
		КОГДА РезультатБезПорядка.Затрата = "резервы отпусков с начислениями"
			ТОГДА 3
		КОГДА РезультатБезПорядка.Группа ПОДОБНО "Охрана труда%"
			ТОГДА ВЫБОР
					КОГДА РезультатБезПорядка.Затрата = "Вода питьевая"
						ТОГДА 1
					КОГДА РезультатБезПорядка.Затрата = "Вода питьевая услуги ЦВС"
						ТОГДА 2
					КОГДА РезультатБезПорядка.Затрата = "Стоки"
						ТОГДА 3
					КОГДА РезультатБезПорядка.Затрата = "Услуги ЦВС"
						ТОГДА 4
					ИНАЧЕ 5
				КОНЕЦ
		КОГДА РезультатБезПорядка.Затрата ПОДОБНО "Покупные%"
			ТОГДА 100
		КОГДА РезультатБезПорядка.Затрата ПОДОБНО "Собственные%"
			ТОГДА 101
		ИНАЧЕ РезультатБезПорядка.ПорядокПодГрупп
	КОНЕЦ КАК ПорядокЗатрат,
	РезультатБезПорядка.СуммаОборот / Задано.КоличествоВыпуск КАК СтоимостьНаЕдиницу,
	РезультатБезПорядка.КоличествоОборот / Задано.КоличествоВыпуск КАК КоличествоНаЕдиницу
ПОМЕСТИТЬ Результат
ИЗ
	РезультатБезПорядка КАК РезультатБезПорядка
		ЛЕВОЕ СОЕДИНЕНИЕ Задано КАК Задано
		ПО РезультатБезПорядка.Организация = Задано.Организация
			И РезультатБезПорядка.Подразделение = Задано.Подразделение
			И РезультатБезПорядка.Продукция = Задано.Продукция
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ИтогоВыпуск.Организация,
	ИтогоВыпуск.Подразделение,
	ИтогоВыпуск.Продукция,
	ИтогоВыпуск.КоличествоВыпуск КАК КоличествоОборот,
	ИтогоВыпуск.СтоимостьСНЗП КАК СуммаОборот,
	ВЫБОР
		КОГДА ИтогоВыпуск.КоличествоВыпуск = 0
			ТОГДА 0
		ИНАЧЕ ИтогоВыпуск.СтоимостьСНЗП / ИтогоВыпуск.КоличествоВыпуск
	КОНЕЦ КАК СтоимостьНаЕдиницу,
	"Производственная себестоимость с НЗП" КАК Раздел
ИЗ
	ИтогоВыпуск КАК ИтогоВыпуск
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	НЗПНаНачало.Организация,
	НЗПНаНачало.Подразделение,
	НЗПНаНачало.Продукция,
	НЗПНаНачало.СуммаОборот,
	НЗПНаНачало.КоличествоОборот,
	НЗПНаНачало.Раздел,
	ВЫБОР
		КОГДА ИтогоВыпуск.КоличествоОборот = 0
			ТОГДА 0
		ИНАЧЕ НЗПНаНачало.СуммаОборот / ИтогоВыпуск.КоличествоОборот
	КОНЕЦ КАК СтоимостьНаЕдиницу,
	ВЫБОР
		КОГДА ИтогоВыпуск.КоличествоОборот = 0
			ТОГДА 0
		ИНАЧЕ НЗПНаНачало.КоличествоОборот / ИтогоВыпуск.КоличествоОборот
	КОНЕЦ КАК КоличествоНаЕдиницу
ИЗ
	НЗПНаНачало КАК НЗПНаНачало
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ИтогоВыпуск КАК ИтогоВыпуск
		ПО НЗПНаНачало.Организация = ИтогоВыпуск.Организация
			И НЗПНаНачало.Подразделение = ИтогоВыпуск.Подразделение
			И НЗПНаНачало.Продукция = ИтогоВыпуск.Продукция
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	НЗПНаКонец.Организация,
	НЗПНаКонец.Подразделение,
	НЗПНаКонец.Продукция,
	НЗПНаКонец.СуммаОборот,
	НЗПНаКонец.КоличествоОборот,
	НЗПНаКонец.Раздел,
	ВЫБОР
		КОГДА ИтогоВыпуск.КоличествоОборот = 0
			ТОГДА 0
		ИНАЧЕ НЗПНаКонец.СуммаОборот / ИтогоВыпуск.КоличествоОборот
	КОНЕЦ КАК СтоимостьНаЕдиницу,
	ВЫБОР
		КОГДА ИтогоВыпуск.КоличествоОборот = 0
			ТОГДА 0
		ИНАЧЕ НЗПНаКонец.КоличествоОборот / ИтогоВыпуск.КоличествоОборот
	КОНЕЦ КАК КоличествоНаЕдиницу
ИЗ
	НЗПНаКонец КАК НЗПНаКонец
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ИтогоВыпуск КАК ИтогоВыпуск
		ПО НЗПНаКонец.Организация = ИтогоВыпуск.Организация
			И НЗПНаКонец.Подразделение = ИтогоВыпуск.Подразделение
			И НЗПНаКонец.Продукция = ИтогоВыпуск.Продукция
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	БазоваяВыборкаЗнВПРасшифровка.Организация,
	БазоваяВыборкаЗнВПРасшифровка.Подразделение,
	БазоваяВыборкаЗнВПРасшифровка.Продукция,
	БазоваяВыборкаЗнВПРасшифровка.СтатьяЗатрат,
	БазоваяВыборкаЗнВПРасшифровка.Затрата,
	БазоваяВыборкаЗнВПРасшифровка.КоличествоОборот,
	БазоваяВыборкаЗнВПРасшифровка.СуммаОборот,
	БазоваяВыборкаЗнВПРасшифровка.НоменклатурнаяГруппаЗатрат,
	БазоваяВыборкаЗнВПРасшифровка.Раздел,
	БазоваяВыборкаЗнВПРасшифровка.Группа,
	БазоваяВыборкаЗнВПРасшифровка.ПодГруппа,
	БазоваяВыборкаЗнВПРасшифровка.ПорядокРазделов,
	БазоваяВыборкаЗнВПРасшифровка.ПорядокГрупп,
	БазоваяВыборкаЗнВПРасшифровка.ПорядокПодГрупп,
	БазоваяВыборкаЗнВПРасшифровка.Регистратор,
	БазоваяВыборкаЗнВПРасшифровка.Нормируемая,
	БазоваяВыборкаЗнВПРасшифровка.ПокупныеСобственные,
	БазоваяВыборкаЗнВПРасшифровка.ЕдиницаИзмерения
ИЗ
	БазоваяВыборкаЗнВПРасшифровка КАК БазоваяВыборкаЗнВПРасшифровка
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Результат.Организация,
	Результат.Подразделение,
	Результат.Продукция,
	Результат.Раздел,
	МАКСИМУМ(Результат.ПорядокРазделов) КАК ПорядокРазделов,
	СУММА(Результат.КоличествоОборот) КАК КоличествоОборот,
	СУММА(Результат.СуммаОборот) КАК СуммаОборот,
	СУММА(Результат.СтоимостьНаЕдиницу) КАК СтоимостьНаЕдиницу,
	СУММА(0) КАК КоличествоНаЕдиницу
ИЗ
	Результат КАК Результат

СГРУППИРОВАТЬ ПО
	Результат.Организация,
	Результат.Подразделение,
	Результат.Продукция,
	Результат.Раздел
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ИтогоВыпуск.Организация,
	ИтогоВыпуск.Подразделение,
	ИтогоВыпуск.Продукция,
	ИтогоВыпуск.КоличествоОборот,
	ИтогоВыпуск.СтоимостьБезНЗП,
	ВЫБОР
		КОГДА ИтогоВыпуск.КоличествоОборот <> 0
			ТОГДА ИтогоВыпуск.СтоимостьБезНЗП / ИтогоВыпуск.КоличествоОборот
		ИНАЧЕ 0
	КОНЕЦ КАК СтоимостьЗаЕдиницу
ИЗ
	ИтогоВыпуск КАК ИтогоВыпуск
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Результат.Организация,
	Результат.Подразделение,
	Результат.Продукция,
	Результат.СтатьяЗатрат,
	Результат.Затрата,
	Результат.КоличествоОборот,
	Результат.СуммаОборот,
	Результат.Раздел,
	Результат.Группа,
	Результат.Подгруппа,
	Результат.ПорядокРазделов,
	Результат.ПорядокГрупп,
	Результат.ПорядокПодГрупп,
	Результат.СтоимостьНаЕдиницу,
	Результат.КоличествоНаЕдиницу,
	Результат.ПорядокЗатрат
ИЗ
	Результат КАК Результат

